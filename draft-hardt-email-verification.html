<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Email Verification Protocol</title>
<meta content="Dick Hardt" name="author">
<meta content="
       This document defines the Email Verification Protocol (EVP), which enables web applications to verify that a user controls an email address without sending a verification email. The protocol uses a three-party model where the browser intermediates between the relying party and an issuer, providing both improved user experience and privacy protection. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="email" name="keyword">
<meta content="verification" name="keyword">
<meta content="identity" name="keyword">
<meta content="authentication" name="keyword">
<meta content="draft-hardt-email-verification-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.2.1
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.5.1
    pycountry 24.6.1
    PyYAML 6.0.3
    requests 2.32.5
    wcwidth 0.2.14
-->
<link href="draft-hardt-email-verification.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">EVP</td>
<td class="right">January 2026</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hardt</td>
<td class="center">Expires 10 July 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">TBD</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-hardt-email-verification-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2026-01-06" class="published">6 January 2026</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-07-10">10 July 2026</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Hardt</div>
<div class="org">Hellō</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Email Verification Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines the Email Verification Protocol (EVP), which enables web applications to verify that a user controls an email address without sending a verification email. The protocol uses a three-party model where the browser intermediates between the relying party and an issuer, providing both improved user experience and privacy protection.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1"><em>Note: This section is to be removed before publishing as an RFC.</em><a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Source for this draft and an issue tracker can be found at <a href="https://github.com/dickhardt/email-verification">https://github.com/dickhardt/email-verification</a>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">The browser API aspects are developed separately at the W3C WICG: <a href="https://github.com/WICG/email-verification-protocol">https://github.com/WICG/email-verification-protocol</a><a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 10 July 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2026 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-the-problem" class="internal xref">The Problem</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-the-solution" class="internal xref">The Solution</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-privacy-protection" class="internal xref">Privacy Protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-key-concepts" class="internal xref">Key Concepts</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="auto internal xref">1.5</a>.  <a href="#name-scope" class="internal xref">Scope</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-protocol-flow" class="internal xref">Protocol Flow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-nonce-generation" class="internal xref">Nonce Generation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-token-request" class="internal xref">Token Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-token-issuance" class="internal xref">Token Issuance</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-error-responses" class="internal xref">Error Responses</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.1">
                    <p id="section-toc.1-1.2.2.4.2.1.1"><a href="#section-2.4.1" class="auto internal xref">2.4.1</a>.  <a href="#name-invalid-content-type-header" class="internal xref">Invalid Content-Type Header</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.2">
                    <p id="section-toc.1-1.2.2.4.2.2.1"><a href="#section-2.4.2" class="auto internal xref">2.4.2</a>.  <a href="#name-invalid-sec-fetch-dest-head" class="internal xref">Invalid Sec-Fetch-Dest Header</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.3">
                    <p id="section-toc.1-1.2.2.4.2.3.1"><a href="#section-2.4.3" class="auto internal xref">2.4.3</a>.  <a href="#name-invalid-or-missing-http-mes" class="internal xref">Invalid or Missing HTTP Message Signature</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.4">
                    <p id="section-toc.1-1.2.2.4.2.4.1"><a href="#section-2.4.4" class="auto internal xref">2.4.4</a>.  <a href="#name-invalid-content-digest" class="internal xref">Invalid Content-Digest</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.5">
                    <p id="section-toc.1-1.2.2.4.2.5.1"><a href="#section-2.4.5" class="auto internal xref">2.4.5</a>.  <a href="#name-authentication-required" class="internal xref">Authentication Required</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.6">
                    <p id="section-toc.1-1.2.2.4.2.6.1"><a href="#section-2.4.6" class="auto internal xref">2.4.6</a>.  <a href="#name-invalid-parameters" class="internal xref">Invalid Parameters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.7">
                    <p id="section-toc.1-1.2.2.4.2.7.1"><a href="#section-2.4.7" class="auto internal xref">2.4.7</a>.  <a href="#name-server-errors" class="internal xref">Server Errors</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="auto internal xref">2.5</a>.  <a href="#name-token-presentation" class="internal xref">Token Presentation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a href="#section-2.6" class="auto internal xref">2.6</a>.  <a href="#name-token-verification" class="internal xref">Token Verification</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-http-message-signature-secu" class="internal xref">HTTP Message Signature Security</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-signature-key-hwk-scheme" class="internal xref">Signature-Key hwk Scheme</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-email-existence-probing" class="internal xref">Email Existence Probing</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-design-rationale" class="internal xref">Design Rationale</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-why-not-solve-email-like-sm" class="internal xref">Why Not Solve Email Like SMS OTP?</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-why-the-three-party-model" class="internal xref">Why the Three-Party Model?</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-why-sd-jwt" class="internal xref">Why SD-JWT?</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-why-dns-delegation" class="internal xref">Why DNS Delegation?</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-why-jwks-over-dkim-keys" class="internal xref">Why JWKS Over DKIM Keys?</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-alternatives-under-consider" class="internal xref">Alternatives Under Consideration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-passkey-authentication" class="internal xref">Passkey Authentication</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-alternatives-considered" class="internal xref">Alternatives Considered</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-use-wellknown-for-mail-doma" class="internal xref">Use .wellknown for Mail Domain delegation to Issuer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-use-request-jwt-instead-of-" class="internal xref">Use Request JWT Instead of HTTP Message Signatures</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-references" class="internal xref">References</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<div id="the-problem">
<section id="section-1.1">
        <h3 id="name-the-problem">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-the-problem" class="section-name selfRef">The Problem</a>
        </h3>
<p id="section-1.1-1">Web applications verify email addresses for two purposes:<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-1.1-2">
<li id="section-1.1-2.1">
            <strong>To send emails to the user</strong> — transactional notifications, marketing, password resets<a href="#section-1.1-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-1.1-2.2">
            <strong>To identify the user</strong> — as a stable identifier for account creation and authentication<a href="#section-1.1-2.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-1.1-3">The standard verification method is to send a one-time code to the email address and have the user enter it. This requires the user to switch to their email client, wait for the message, find it, read the code, and return to enter it. Studies show non-completion rates of 20-40%.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4"><strong>SMS verification had the same problem</strong><a href="#section-1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.1-5">Phone number verification uses the same one-time code pattern: send a code via SMS, have the user enter it. This had similar friction until the industry developed standards to streamline it.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<p id="section-1.1-6"><strong>How SMS solved it</strong><a href="#section-1.1-6" class="pilcrow">¶</a></p>
<p id="section-1.1-7">The WebOTP API and the <code>autocomplete="one-time-code"</code> HTML attribute enable SMS codes to auto-fill with a single tap. The SMS arrives within seconds, the operating system parses the origin-bound code format, and the browser offers to fill it automatically. The user never leaves the application.<a href="#section-1.1-7" class="pilcrow">¶</a></p>
<p id="section-1.1-8"><strong>Why email cannot use the same approach</strong><a href="#section-1.1-8" class="pilcrow">¶</a></p>
<p id="section-1.1-9">Email verification cannot benefit from these standards:<a href="#section-1.1-9" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-1.1-10.1">
            <strong>Latency</strong>: SMS arrives in seconds; email takes seconds to minutes depending on server processing, spam filtering, and delivery queues.<a href="#section-1.1-10.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-1.1-10.2">
            <strong>Spam filtering</strong>: Verification emails frequently land in spam or promotions folders. SMS has no equivalent filtering.<a href="#section-1.1-10.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-1.1-10.3">
            <strong>Distraction</strong>: When users switch to their email client, they see their entire inbox. Many get sidetracked by other messages and never return. SMS notifications appear briefly; there is no "SMS inbox" to get lost in.<a href="#section-1.1-10.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-1.1-10.4">
            <strong>No autofill path</strong>: There is no mechanism for the operating system to parse an email and offer one-tap autofill back to the originating browser tab.<a href="#section-1.1-10.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-11"><strong>Optimizations that exist today</strong><a href="#section-1.1-11" class="pilcrow">¶</a></p>
<p id="section-1.1-12">Two approaches optimize away the email code flow:<a href="#section-1.1-12" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.1-13">
<li id="section-1.1-13.1">
            <p id="section-1.1-13.1.1"><strong>Social login</strong>: When a user is already authenticated with Google, Apple, or another identity provider, the application can obtain a verified email without sending any verification message. However, this requires the user to have and use a social account, and requires developers to integrate with each provider.<a href="#section-1.1-13.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.1-13.2">
            <p id="section-1.1-13.2.1"><strong>Email Verification Protocol (EVP)</strong>: This specification. When the user is logged into their email provider (as most users are in their browser), EVP enables instant verification without sending an email and without leaving the page.<a href="#section-1.1-13.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-1.1-14">Both are optimizations. The email code flow remains the universal fallback—it works for any email address regardless of provider support. But for users who are logged into a supporting provider, these optimizations eliminate the friction entirely.<a href="#section-1.1-14" class="pilcrow">¶</a></p>
<p id="section-1.1-15"><strong>The privacy advantage of EVP</strong><a href="#section-1.1-15" class="pilcrow">¶</a></p>
<p id="section-1.1-16">Beyond user experience, there is a privacy dimension. Both email OTP and social login reveal to a third party which applications the user interacts with—the email provider sees verification emails, and the identity provider sees OAuth redirects. EVP is designed to prevent this: the issuer never learns which application requested verification. See <a href="#privacy-protection">Privacy Protection</a> for details.<a href="#section-1.1-16" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-solution">
<section id="section-1.2">
        <h3 id="name-the-solution">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-the-solution" class="section-name selfRef">The Solution</a>
        </h3>
<p id="section-1.2-1">The Email Verification Protocol enables a web application to obtain a verified email address <strong>without sending an email</strong> and <strong>without the user leaving the web page</strong>. The user simply selects their email address from the browser's autocomplete, and verification happens instantly in the background.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">To enable this functionality, the mail domain delegates email verification to an issuer that has authentication cookies for the user. When the user provides an email to the HTML form field, the browser calls the issuer using an HTTP Message Signed request (<a href="https://datatracker.ietf.org/doc/html/rfc9421">RFC 9421</a>), passing authentication cookies and the browser's public key via the Signature-Key header (<a href="https://datatracker.ietf.org/doc/draft-hardt-httpbis-signature-key/">draft-hardt-httpbis-signature-key</a>). The issuer returns a token, which the browser verifies and updates and provides to the web application. The web application then verifies the token and has a verified email address for the user.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-protection">
<section id="section-1.3">
        <h3 id="name-privacy-protection">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-privacy-protection" class="section-name selfRef">Privacy Protection</a>
        </h3>
<p id="section-1.3-1">When an application only wants the email address to identify the user—not to send emails—the verification method determines what third parties learn about the user's activity:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2"><strong>Email OTP</strong>: The email provider learns which applications the user is interacting with and when, through the verification emails it delivers. The provider sees the sender, subject line, and delivery timing for every verification. If the application will send emails anyway (welcome messages, notifications), this disclosure is unavoidable. But for applications that only need the email for identification, sending a verification email creates an unnecessary privacy leak.<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<p id="section-1.3-3"><strong>Social login</strong>: The identity provider learns which applications the user visits, because the application redirects the user to the provider and identifies itself in the OAuth request. The provider sees every login across every application.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
<p id="section-1.3-4"><strong>EVP's three-party model</strong>: EVP is designed so the issuer never learns which application requested verification. The browser intermediates between the RP and the issuer, obtaining an issuance token (EVT) from the issuer and then creating a separate presentation token (EVT+KB) for the RP. This architectural indirection—rather than a simple API where the issuer creates a token directly for the application—ensures the issuer cannot track which applications the user interacts with.<a href="#section-1.3-4" class="pilcrow">¶</a></p>
<p id="section-1.3-5">This is accomplished through key binding: the browser generates a fresh key pair, the issuer binds the EVT to that public key (in the <code>cnf</code> claim), and the browser uses the private key to create a Key Binding JWT (KB-JWT) that includes the RP's audience and nonce. The issuer never sees the RP's identity; it only sees the browser's ephemeral public key.<a href="#section-1.3-5" class="pilcrow">¶</a></p>
<p id="section-1.3-6"><strong>When privacy protection matters</strong>: This protection is most important when the email is being used by the RP to identify the user (e.g., for login or account linking). If the RP subsequently sends an email to the user anyway (e.g., a welcome email), the email provider will learn about that interaction through traditional email transmission. However, even in these cases, the issuer (which may be separate from the email provider) does not learn which RPs requested verification, and the timing of verification requests is not revealed through email metadata.<a href="#section-1.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-concepts">
<section id="section-1.4">
        <h3 id="name-key-concepts">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-key-concepts" class="section-name selfRef">Key Concepts</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-1.4-1.1">
            <p id="section-1.4-1.1.1"><strong>EVT (Email Verification Token)</strong>: An Email Verification Token is a JWT issued by an issuer that asserts the user controls a specific email address. The EVT contains the <code>email</code> and <code>email_verified</code> claims for the user, and the public key used by the browser to make the request in the <code>cnf</code> (confirmation) claim. The EVT uses the same structure as an SD-JWT (Selective Disclosure JWT) as specified in <a href="https://datatracker.ietf.org/doc/draft-ietf-oauth-selective-disclosure-jwt/">Selective Disclosure for JWT</a>, but does not use the selective disclosure features - it only uses the key binding capability. EVTs can be parsed and validated using standard SD-JWT libraries.<a href="#section-1.4-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-1.2">
            <p id="section-1.4-1.2.1"><strong>EVT+KB (Email Verification Token with Key Binding)</strong>: The presentation token composed of an EVT and a Key Binding JWT (KB-JWT) separated by the <code>~</code> character. The KB-JWT is signed by the browser and contains a hash of the EVT along with the RP's audience and nonce. This two-part structure enables a separation of token issuance and token presentation: the issuer creates the EVT without knowing which RP will receive it, and the browser binds the EVT to a specific RP through the KB-JWT. This enables the RP to verify the issuer provided the email address for the user without the issuer learning about the specific application.<a href="#section-1.4-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-1.3">
            <p id="section-1.4-1.3.1"><strong>Issuer</strong>: The service that verifies the user controls an email address. A DNS record for the email domain delegates email verification to the issuer. The issuer serves a <code>.well-known/email-verification</code> metadata file that contains its <code>issuance_endpoint</code> that is called to obtain an EVT, and its <code>jwks_uri</code> that points to the JWKS file containing the public keys used to verify the EVT. The issuer is identified by its domain, an eTLD+1 (eg <code>issuer.example</code>). The hostname in all URLs from the issuer's metadata MUST end with the issuer's domain. This identifier is what binds the EVT, the DNS delegation, with the issuer.<a href="#section-1.4-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-1.4">
            <p id="section-1.4-1.4.1"><strong>HTTP Message Signatures</strong>: This protocol uses <a href="https://datatracker.ietf.org/doc/html/rfc9421">RFC 9421</a> to sign the HTTP request from the browser to the issuer. The signature binds the browser's public key, the cookies, and the request content together in a verifiable way.<a href="#section-1.4-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-1.5">
            <p id="section-1.4-1.5.1"><strong>Signature-Key Header</strong>: The browser's public key is transmitted using the Signature-Key header with the <code>hwk</code> (Header Web Key) scheme as defined in <a href="https://datatracker.ietf.org/doc/draft-hardt-httpbis-signature-key/">draft-hardt-httpbis-signature-key</a>. This provides a self-contained, pseudonymous way to distribute the public key inline with the request.<a href="#section-1.4-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="scope">
<section id="section-1.5">
        <h3 id="name-scope">
<a href="#section-1.5" class="section-number selfRef">1.5. </a><a href="#name-scope" class="section-name selfRef">Scope</a>
        </h3>
<p id="section-1.5-1">This document specifies the IETF protocol aspects of email verification: the HTTP-level interactions between the browser, issuer, and relying party. How the browser obtains the email address from the user (browser APIs, user interface elements, etc.) is out of scope for this specification and is addressed in separate W3C work.<a href="#section-1.5-1" class="pilcrow">¶</a></p>
<p id="section-1.5-2"><strong>Note on deliverability</strong>: This protocol verifies that the user controls an email address. It does not verify that the email address can receive mail. An issuer may verify addresses that exist only as aliases, or addresses at domains with misconfigured mail servers. RPs that intend to send email should still handle delivery failures appropriately.<a href="#section-1.5-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="protocol-flow">
<section id="section-2">
      <h2 id="name-protocol-flow">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-protocol-flow" class="section-name selfRef">Protocol Flow</a>
      </h2>
<p id="section-2-1">The protocol consists of five steps:<a href="#section-2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-2-2">
<li id="section-2-2.1">Nonce Generation<a href="#section-2-2.1" class="pilcrow">¶</a>
</li>
        <li id="section-2-2.2">Token Request<a href="#section-2-2.2" class="pilcrow">¶</a>
</li>
        <li id="section-2-2.3">Token Issuance<a href="#section-2-2.3" class="pilcrow">¶</a>
</li>
        <li id="section-2-2.4">Token Presentation<a href="#section-2-2.4" class="pilcrow">¶</a>
</li>
        <li id="section-2-2.5">Token Verification<a href="#section-2-2.5" class="pilcrow">¶</a>
</li>
      </ol>
<div class="lang-mermaid sourcecode" id="section-2-3">
<pre>sequenceDiagram
    participant B as Browser
    participant RPS as RP Server
    participant I as Issuer
    participant DNS as DNS

    Note over B,DNS: Step 1: Nonce Generation
    B-&gt;&gt;RPS: Request nonce
    RPS-&gt;&gt;RPS: Generate nonce, bind to session
    RPS-&gt;&gt;B: Return nonce

    Note over B,DNS: Step 2: Token Request
    Note over B: Browser has email address&lt;br/&gt;(mechanism out of scope)
    B-&gt;&gt;DNS: DNS TXT lookup&lt;br/&gt;_email-verification.$EMAIL_DOMAIN
    DNS-&gt;&gt;B: Return iss=issuer.example
    B-&gt;&gt;I: GET /.well-known/email-verification
    I-&gt;&gt;B: Return metadata
    B-&gt;&gt;B: Generate key pair&lt;br/&gt;Create signed request
    B-&gt;&gt;I: POST with HTTP Message Signature&lt;br/&gt;Signature-Key: sig=hwk

    Note over B,DNS: Step 3: Token Issuance
    I-&gt;&gt;I: Verify HTTP signature&lt;br/&gt;Extract public key from Signature-Key
    I-&gt;&gt;I: Generate EVT
    I-&gt;&gt;B: {"issuance_token":"EVT"}

    Note over B,DNS: Step 4: Token Presentation
    B-&gt;&gt;B: Verify EVT
    B-&gt;&gt;I: GET jwks_uri for public keys
    I-&gt;&gt;B: Return JWKS
    B-&gt;&gt;B: Create KB-JWT
    B-&gt;&gt;RPS: Send EVT+KB

    Note over B,DNS: Step 5: Token Verification
    RPS-&gt;&gt;RPS: Parse EVT+KB
    RPS-&gt;&gt;DNS: DNS TXT lookup for email domain
    DNS-&gt;&gt;RPS: Return iss=issuer.example
    RPS-&gt;&gt;I: GET /.well-known/email-verification
    I-&gt;&gt;RPS: Return metadata with jwks_uri
    RPS-&gt;&gt;I: GET jwks_uri
    I-&gt;&gt;RPS: Return JWKS public keys
    RPS-&gt;&gt;RPS: Verify EVT
    RPS-&gt;&gt;RPS: Verify KB-JWT
    RPS-&gt;&gt;RPS: Email verification complete

</pre><a href="#section-2-3" class="pilcrow">¶</a>
</div>
<div id="nonce-generation">
<section id="section-2.1">
        <h3 id="name-nonce-generation">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-nonce-generation" class="section-name selfRef">Nonce Generation</a>
        </h3>
<p id="section-2.1-1">Before requesting email verification, the browser obtains a nonce from the RP:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.1">
            <p id="section-2.1-2.1.1"><strong>1.1</strong> - The browser requests a nonce from the RP Server (mechanism for this request is out of scope - may be via XHR, fetch, or server-rendered in HTML)<a href="#section-2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.2">
            <p id="section-2.1-2.2.1"><strong>1.2</strong> - The RP Server generates a cryptographically random nonce and binds it to the user's session<a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.3">
            <p id="section-2.1-2.3.1"><strong>1.3</strong> - The RP Server returns the nonce to the browser<a href="#section-2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.1-3">The nonce will be included in the Key Binding JWT (step 4) to bind the verification to this specific RP session and prevent replay attacks.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-request">
<section id="section-2.2">
        <h3 id="name-token-request">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-token-request" class="section-name selfRef">Token Request</a>
        </h3>
<p id="section-2.2-1">Once the browser has obtained an email address (mechanism out of scope) and a nonce from the RP:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-2.2-2.1">
            <strong>2.1</strong> - The browser parses the email domain (<code>EMAIL_DOMAIN) from the email address, looks up the `TXT` record for `_email-verification.</code>EMAIL_DOMAIN<code>. The contents of the record MUST start with</code>iss=<code>followed by the issuer identifier. There MUST be only one</code>TXT<code>record for</code>_email-verification.$EMAIL_DOMAIN`.<a href="#section-2.2-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.2-3">Example record:<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<div class="lang-bash sourcecode" id="section-2.2-4">
<pre>_email-verification.email-domain.example   TXT   iss=issuer.example

</pre><a href="#section-2.2-4" class="pilcrow">¶</a>
</div>
<p id="section-2.2-5">This record states that <code>email-domain.example</code> has delegated email verification to the issuer <code>issuer.example</code>.<a href="#section-2.2-5" class="pilcrow">¶</a></p>
<p id="section-2.2-6">If the email domain and the issuer are the same domain, then the record would be:<a href="#section-2.2-6" class="pilcrow">¶</a></p>
<div class="lang-bash sourcecode" id="section-2.2-7">
<pre>_email-verification.issuer.example   TXT   iss=issuer.example

</pre><a href="#section-2.2-7" class="pilcrow">¶</a>
</div>
<blockquote id="section-2.2-8">
          <p id="section-2.2-8.1">Access to DNS records and email is often independent of website deployments. This provides assurance that an issuer is truly authorized as an insider with only access to websites on <code>issuer.example</code> could not setup an issuer that would grant them verified emails for any email at <code>issuer.example</code>.<a href="#section-2.2-8.1" class="pilcrow">¶</a></p>
</blockquote>
<ul class="compact">
<li class="compact" id="section-2.2-9.1">
            <strong>2.2</strong> - If an issuer is found, the browser loads <code>https://$ISSUER$/.well-known/email-verification</code> and MUST follow redirects to the same path but with a different subdomain of the Issuer.<a href="#section-2.2-9.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.2-10">For example, <code>https://issuer.example/.well-known/email-verification</code> may redirect to <code>https://accounts.issuer.example/.well-known/email-verification</code>.<a href="#section-2.2-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-11.1">
            <p id="section-2.2-11.1.1"><strong>2.3</strong> - The browser confirms that the <code>.well-known/email-verification</code> file contains JSON that includes the following properties:<a href="#section-2.2-11.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-11.2">
            <p id="section-2.2-11.2.1"><em>issuance_endpoint</em> - the API endpoint the browser calls to obtain an EVT<a href="#section-2.2-11.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-11.3">
            <p id="section-2.2-11.3.1"><em>jwks_uri</em> - the URL where the issuer provides its public keys to verify the EVT<a href="#section-2.2-11.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-11.4">
            <p id="section-2.2-11.4.1"><em>signing_alg_values_supported</em> - OPTIONAL. JSON array containing a list of the signing algorithms ("alg" values) supported by the issuer for both HTTP Message Signatures and issued EVTs. Algorithm identifiers MUST be from the IANA "JSON Web Signature and Encryption Algorithms" registry. If omitted, "EdDSA" is the default. "EdDSA" SHOULD be included in the supported algorithms list. The value "none" MUST NOT be used.<a href="#section-2.2-11.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.2-12">Each of these properties MUST include the issuer domain as the root of their hostname.<a href="#section-2.2-12" class="pilcrow">¶</a></p>
<p id="section-2.2-13">Following is an example <code>.well-known/email-verification</code> file:<a href="#section-2.2-13" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-2.2-14">
<pre>{
  "issuance_endpoint": "https://accounts.issuer.example/email-verification/issuance",
  "jwks_uri": "https://accounts.issuer.example/email-verification/jwks",
  "signing_alg_values_supported": ["EdDSA", "RS256"]
}

</pre><a href="#section-2.2-14" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-2.2-15.1">
            <p id="section-2.2-15.1.1"><strong>2.4</strong> - The browser generates a fresh private / public key pair. The browser SHOULD select an algorithm from the issuer's <code>signing_alg_values_supported</code> array, or use "EdDSA" if the property is not present.<a href="#section-2.2-15.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-15.2">
            <p id="section-2.2-15.2.1"><strong>2.5</strong> - The browser creates an HTTP Message Signature (<a href="https://datatracker.ietf.org/doc/html/rfc9421">RFC 9421</a>) request by:<a href="#section-2.2-15.2.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="section-2.2-15.2.2.1">Creating a JSON request body with the email address:<a href="#section-2.2-15.2.2.1" class="pilcrow">¶</a>
</li>
            </ul>
<div class="lang-json sourcecode" id="section-2.2-15.2.3">
<pre>{
  "email": "user@example.com"
}

</pre><a href="#section-2.2-15.2.3" class="pilcrow">¶</a>
</div>
<ul class="compact normal">
<li class="compact normal" id="section-2.2-15.2.4.1">Computing the <code>Content-Digest</code> header per <a href="https://datatracker.ietf.org/doc/html/rfc9530">RFC 9530</a> using SHA-256:<a href="#section-2.2-15.2.4.1" class="pilcrow">¶</a>
</li>
            </ul>
<div class="alignLeft art-text artwork" id="section-2.2-15.2.5">
<pre>Content-Digest: sha-256=:X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=:

</pre><a href="#section-2.2-15.2.5" class="pilcrow">¶</a>
</div>
<ul class="compact normal">
<li class="compact normal" id="section-2.2-15.2.6.1">Creating the <code>Signature-Input</code> header specifying which components to sign:<a href="#section-2.2-15.2.6.1" class="pilcrow">¶</a>
</li>
            </ul>
<div class="alignLeft art-text artwork" id="section-2.2-15.2.7">
<pre>Signature-Input: sig=("@method" "@target-uri" "@authority" "content-digest" "cookie" "sec-fetch-dest"); created=1692345600; keyid="browser-key"; alg="ed25519"

</pre><a href="#section-2.2-15.2.7" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-2.2-15.2.8.1">
                <p id="section-2.2-15.2.8.1.1">Computing the signature base per RFC 9421 Section 2.5 and signing it with the browser's private key<a href="#section-2.2-15.2.8.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2-15.2.8.2">
                <p id="section-2.2-15.2.8.2.1">Creating the <code>Signature</code> header with the base64-encoded signature:<a href="#section-2.2-15.2.8.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<div class="alignLeft art-text artwork" id="section-2.2-15.2.9">
<pre>Signature: sig=:MEQCIHd8Y8qYKm5e3dV8y....:

</pre><a href="#section-2.2-15.2.9" class="pilcrow">¶</a>
</div>
<ul class="compact normal">
<li class="compact normal" id="section-2.2-15.2.10.1">Creating the <code>Signature-Key</code> header using the <code>hwk</code> scheme (<a href="https://datatracker.ietf.org/doc/draft-hardt-httpbis-signature-key/">draft-hardt-httpbis-signature-key</a>) with the browser's public key:<a href="#section-2.2-15.2.10.1" class="pilcrow">¶</a>
</li>
            </ul>
<div class="alignLeft art-text artwork" id="section-2.2-15.2.11">
<pre>Signature-Key: sig=hwk; kty="OKP"; crv="Ed25519"; x="JrQLj5P_89iXES9-vFgrIy29clF9CC_oPPsw3c5D0bs"

</pre><a href="#section-2.2-15.2.11" class="pilcrow">¶</a>
</div>
</li>
          <li class="normal" id="section-2.2-15.3">
            <p id="section-2.2-15.3.1"><strong>2.6</strong> - The browser POSTs to the <code>issuance_endpoint</code> of the issuer with 1P cookies:<a href="#section-2.2-15.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="lang-http sourcecode" id="section-2.2-16">
<pre>POST /email-verification/issuance HTTP/1.1
Host: accounts.issuer.example
Cookie: session=...
Content-Type: application/json
Content-Digest: sha-256=:X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=:
Sec-Fetch-Dest: email-verification
Signature-Input: sig=("@method" "@target-uri" "@authority" "content-digest" "cookie" "sec-fetch-dest"); created=1692345600; keyid="browser-key"; alg="ed25519"
Signature: sig=:MEQCIHd8Y8qYKm5e3dV8y....:
Signature-Key: sig=hwk; kty="OKP"; crv="Ed25519"; x="JrQLj5P_89iXES9-vFgrIy29clF9CC_oPPsw3c5D0bs"

{"email":"user@example.com"}

</pre><a href="#section-2.2-16" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="token-issuance">
<section id="section-2.3">
        <h3 id="name-token-issuance">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-token-issuance" class="section-name selfRef">Token Issuance</a>
        </h3>
<p id="section-2.3-1">On receipt of a token request from the browser:<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3-2.1">
            <p id="section-2.3-2.1.1"><strong>3.1</strong> - The issuer MUST verify the request headers:<a href="#section-2.3-2.1.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="section-2.3-2.1.2.1">
                <code>Content-Type</code> is <code>application/json</code><a href="#section-2.3-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.3-2.1.2.2">
                <code>Sec-Fetch-Dest</code> is <code>email-verification</code><a href="#section-2.3-2.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.3-2.1.2.3">
                <code>Content-Digest</code> is present<a href="#section-2.3-2.1.2.3" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.3-2.1.2.4">
                <code>Signature-Input</code> is present<a href="#section-2.3-2.1.2.4" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.3-2.1.2.5">
                <code>Signature</code> is present<a href="#section-2.3-2.1.2.5" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.3-2.1.2.6">
                <code>Signature-Key</code> is present with <code>sig=hwk</code> scheme<a href="#section-2.3-2.1.2.6" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-2.3-2.2">
            <p id="section-2.3-2.2.1"><strong>3.2</strong> - The issuer MUST verify the HTTP Message Signature per <a href="https://datatracker.ietf.org/doc/html/rfc9421">RFC 9421</a> by:<a href="#section-2.3-2.2.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="section-2.3-2.2.2.1">Parsing the <code>Signature-Key</code> header and extracting the public key from the <code>hwk</code> parameters (<code>kty</code>, <code>crv</code>, <code>x</code> for OKP keys)<a href="#section-2.3-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.3-2.2.2.2">Parsing the <code>Signature-Input</code> header to determine the covered components<a href="#section-2.3-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.3-2.2.2.3">Verifying that the signature covers at minimum: <code>@method</code>, <code>@target-uri</code>, <code>@authority</code>, <code>content-digest</code>, <code>cookie</code>, and <code>sec-fetch-dest</code><a href="#section-2.3-2.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.3-2.2.2.4">Reconstructing the signature base per RFC 9421 Section 2.5<a href="#section-2.3-2.2.2.4" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.3-2.2.2.5">Verifying the signature in the <code>Signature</code> header using the extracted public key<a href="#section-2.3-2.2.2.5" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.3-2.2.2.6">Verifying the <code>created</code> timestamp in <code>Signature-Input</code> is within 60 seconds of the current time<a href="#section-2.3-2.2.2.6" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-2.3-2.3">
            <p id="section-2.3-2.3.1"><strong>3.3</strong> - The issuer MUST verify the request body:<a href="#section-2.3-2.3.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="section-2.3-2.3.2.1">Parsing the JSON body and extracting the <code>email</code> field<a href="#section-2.3-2.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.3-2.3.2.2">Verifying the <code>email</code> field contains a syntactically valid email address<a href="#section-2.3-2.3.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.3-2.3.2.3">Verifying the <code>Content-Digest</code> matches the actual request body<a href="#section-2.3-2.3.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-2.3-2.4">
            <p id="section-2.3-2.4.1"><strong>3.4</strong> - The issuer checks if the cookies sent represent a logged in user, and if the logged in user has control of the email provided in the request body. If so the issuer generates an EVT with the following properties:<a href="#section-2.3-2.4.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="section-2.3-2.4.2.1">
                <p id="section-2.3-2.4.2.1.1"><strong>Header</strong>: MUST contain<a href="#section-2.3-2.4.2.1.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="section-2.3-2.4.2.1.2.1">
                    <code>alg</code>: signing algorithm (SHOULD match the algorithm from the HTTP Message Signature)<a href="#section-2.3-2.4.2.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="compact normal" id="section-2.3-2.4.2.1.2.2">
                    <code>kid</code>: key identifier of key used to sign<a href="#section-2.3-2.4.2.1.2.2" class="pilcrow">¶</a>
</li>
                  <li class="compact normal" id="section-2.3-2.4.2.1.2.3">
                    <code>typ</code> set to "evt+jwt"<a href="#section-2.3-2.4.2.1.2.3" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="compact normal" id="section-2.3-2.4.2.2">
                <p id="section-2.3-2.4.2.2.1"><strong>Payload</strong>: MUST contain the following claims:<a href="#section-2.3-2.4.2.2.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="section-2.3-2.4.2.2.2.1">
                    <code>iss</code>: the issuer identifier<a href="#section-2.3-2.4.2.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="compact normal" id="section-2.3-2.4.2.2.2.2">
                    <code>iat</code>: issued at time<a href="#section-2.3-2.4.2.2.2.2" class="pilcrow">¶</a>
</li>
                  <li class="compact normal" id="section-2.3-2.4.2.2.2.3">
                    <code>cnf</code>: confirmation claim containing the public key from the Signature-Key header's <code>hwk</code> parameters<a href="#section-2.3-2.4.2.2.2.3" class="pilcrow">¶</a>
</li>
                  <li class="compact normal" id="section-2.3-2.4.2.2.2.4">
                    <code>email</code>: claim containing the email address from the request body<a href="#section-2.3-2.4.2.2.2.4" class="pilcrow">¶</a>
</li>
                  <li class="compact normal" id="section-2.3-2.4.2.2.2.5">
                    <code>email_verified</code>: claim that email is verified per OpenID Connect 1.0<a href="#section-2.3-2.4.2.2.2.5" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="compact normal" id="section-2.3-2.4.2.3">
                <strong>Signature</strong>: MUST be signed with the issuer's private key corresponding to a public key in the <code>jwks_uri</code> identified by <code>kid</code><a href="#section-2.3-2.4.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-2.3-3">Example header:<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-2.3-4">
<pre>  {
    "alg": "EdDSA",
    "kid": "2024-08-19",
    "typ": "evt+jwt"
  }

</pre><a href="#section-2.3-4" class="pilcrow">¶</a>
</div>
<p id="section-2.3-5">Example payload:<a href="#section-2.3-5" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-2.3-6">
<pre>  {
    "iss": "issuer.example",
    "iat": 1724083200,
    "cnf": {
      "jwk": {
        "kty": "OKP",
        "crv": "Ed25519",
        "x": "JrQLj5P_89iXES9-vFgrIy29clF9CC_oPPsw3c5D0bs"
      }
    },
    "email": "user@example.com",
    "email_verified": true
  }

</pre><a href="#section-2.3-6" class="pilcrow">¶</a>
</div>
<p id="section-2.3-7">The resulting JWT has the <code>~</code> appended to it, making it compatible with the SD-JWT structure (though this protocol does not use selective disclosure features). Standard SD-JWT libraries can be used to parse and validate EVTs.<a href="#section-2.3-7" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-2.3-8.1">
            <strong>3.5</strong> - The issuer returns the EVT to the browser as the value of <code>issuance_token</code> in an <code>application/json</code> response.<a href="#section-2.3-8.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.3-9">Example:<a href="#section-2.3-9" class="pilcrow">¶</a></p>
<div class="lang-bash sourcecode" id="section-2.3-10">
<pre>HTTP/1.1 200 OK
Content-Type: application/json

{"issuance_token":"eyJhbGciOiJFZERTQSIsImtpZCI6IjIwMjQtMDgtMTkiLCJ0eXAiOiJ3ZWItaWRlbnRpdHkrc2Qtand0In0..."}

</pre><a href="#section-2.3-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="error-responses">
<section id="section-2.4">
        <h3 id="name-error-responses">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-error-responses" class="section-name selfRef">Error Responses</a>
        </h3>
<p id="section-2.4-1">If the issuer cannot process the token request successfully, it MUST return an appropriate HTTP status code with a JSON error response containing an <code>error</code> field and optionally an <code>error_description</code> field.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<div id="invalid-content-type-header">
<section id="section-2.4.1">
          <h4 id="name-invalid-content-type-header">
<a href="#section-2.4.1" class="section-number selfRef">2.4.1. </a><a href="#name-invalid-content-type-header" class="section-name selfRef">Invalid Content-Type Header</a>
          </h4>
<p id="section-2.4.1-1">When the request does not include the required <code>Content-Type: application/json</code> header, the server MUST return the 415 HTTP response code<a href="#section-2.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="invalid-sec-fetch-dest-header">
<section id="section-2.4.2">
          <h4 id="name-invalid-sec-fetch-dest-head">
<a href="#section-2.4.2" class="section-number selfRef">2.4.2. </a><a href="#name-invalid-sec-fetch-dest-head" class="section-name selfRef">Invalid Sec-Fetch-Dest Header</a>
          </h4>
<p id="section-2.4.2-1">When the request does not include the required <code>Sec-Fetch-Dest: email-verification</code> header:<a href="#section-2.4.2-1" class="pilcrow">¶</a></p>
<p id="section-2.4.2-2"><strong>HTTP 400 Bad Request</strong><a href="#section-2.4.2-2" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-2.4.2-3">
<pre>{
  "error": "invalid-request",
  "error_description": "Missing or invalid Sec-Fetch-Dest header"
}

</pre><a href="#section-2.4.2-3" class="pilcrow">¶</a>
</div>
<p id="section-2.4.2-4">The <code>error_description</code> SHOULD specify that the Sec-Fetch-Dest header is missing or invalid.<a href="#section-2.4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="invalid-or-missing-http-message-signature">
<section id="section-2.4.3">
          <h4 id="name-invalid-or-missing-http-mes">
<a href="#section-2.4.3" class="section-number selfRef">2.4.3. </a><a href="#name-invalid-or-missing-http-mes" class="section-name selfRef">Invalid or Missing HTTP Message Signature</a>
          </h4>
<p id="section-2.4.3-1">When the HTTP Message Signature is missing, malformed, or verification fails:<a href="#section-2.4.3-1" class="pilcrow">¶</a></p>
<p id="section-2.4.3-2"><strong>HTTP 400 Bad Request</strong><a href="#section-2.4.3-2" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-2.4.3-3">
<pre>{
  "error": "invalid_signature",
  "error_description": "HTTP Message Signature verification failed"
}

</pre><a href="#section-2.4.3-3" class="pilcrow">¶</a>
</div>
<p id="section-2.4.3-4">This includes cases where:
- The <code>Signature</code>, <code>Signature-Input</code>, or <code>Signature-Key</code> headers are missing
- The <code>Signature-Key</code> header does not use the <code>hwk</code> scheme or is malformed
- The signature does not cover the required components
- The signature verification fails using the public key from <code>Signature-Key</code>
- The <code>created</code> timestamp is outside the acceptable time window<a href="#section-2.4.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="invalid-content-digest">
<section id="section-2.4.4">
          <h4 id="name-invalid-content-digest">
<a href="#section-2.4.4" class="section-number selfRef">2.4.4. </a><a href="#name-invalid-content-digest" class="section-name selfRef">Invalid Content-Digest</a>
          </h4>
<p id="section-2.4.4-1">When the <code>Content-Digest</code> header is missing or does not match the request body:<a href="#section-2.4.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4.4-2"><strong>HTTP 400 Bad Request</strong><a href="#section-2.4.4-2" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-2.4.4-3">
<pre>{
  "error": "invalid_request",
  "error_description": "Content-Digest header missing or does not match request body"
}

</pre><a href="#section-2.4.4-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authentication-required">
<section id="section-2.4.5">
          <h4 id="name-authentication-required">
<a href="#section-2.4.5" class="section-number selfRef">2.4.5. </a><a href="#name-authentication-required" class="section-name selfRef">Authentication Required</a>
          </h4>
<p id="section-2.4.5-1">When the request lacks valid authentication cookies, contains expired/invalid cookies, or the authenticated user does not have control of the requested email address:<a href="#section-2.4.5-1" class="pilcrow">¶</a></p>
<p id="section-2.4.5-2"><strong>HTTP 401 Unauthorized</strong><a href="#section-2.4.5-2" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-2.4.5-3">
<pre>{
  "error": "authentication_required",
  "error_description": "User must be authenticated and have control of the requested email address"
}

</pre><a href="#section-2.4.5-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="invalid-parameters">
<section id="section-2.4.6">
          <h4 id="name-invalid-parameters">
<a href="#section-2.4.6" class="section-number selfRef">2.4.6. </a><a href="#name-invalid-parameters" class="section-name selfRef">Invalid Parameters</a>
          </h4>
<p id="section-2.4.6-1">When the request body is malformed, missing the <code>email</code> field, or contains invalid values:<a href="#section-2.4.6-1" class="pilcrow">¶</a></p>
<p id="section-2.4.6-2"><strong>HTTP 400 Bad Request</strong><a href="#section-2.4.6-2" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-2.4.6-3">
<pre>{
  "error": "invalid_request",
  "error_description": "Invalid or malformed request body"
}

</pre><a href="#section-2.4.6-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="server-errors">
<section id="section-2.4.7">
          <h4 id="name-server-errors">
<a href="#section-2.4.7" class="section-number selfRef">2.4.7. </a><a href="#name-server-errors" class="section-name selfRef">Server Errors</a>
          </h4>
<p id="section-2.4.7-1">For internal server errors or temporary unavailability:<a href="#section-2.4.7-1" class="pilcrow">¶</a></p>
<p id="section-2.4.7-2"><strong>HTTP 500 Internal Server Error</strong><a href="#section-2.4.7-2" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-2.4.7-3">
<pre>{
  "error": "server_error",
  "error_description": "Temporary server error, please try again later"
}

</pre><a href="#section-2.4.7-3" class="pilcrow">¶</a>
</div>
<blockquote id="section-2.4.7-4">
            <p id="section-2.4.7-4.1">In a future version of this spec, the issuer could prompt the user to login via a URL or with a Passkey request.<a href="#section-2.4.7-4.1" class="pilcrow">¶</a></p>
</blockquote>
</section>
</div>
</section>
</div>
<div id="token-presentation">
<section id="section-2.5">
        <h3 id="name-token-presentation">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-token-presentation" class="section-name selfRef">Token Presentation</a>
        </h3>
<p id="section-2.5-1">On receiving the <code>issuance_token</code> from the issuer:<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.5-2.1">
            <p id="section-2.5-2.1.1"><strong>4.1</strong> - The browser MUST verify the EVT by:<a href="#section-2.5-2.1.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="section-2.5-2.1.2.1">parsing the EVT into header, payload, and signature components<a href="#section-2.5-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.5-2.1.2.2">confirming the presence of, and extracting the <code>alg</code> and <code>kid</code> fields from the EVT header, and the <code>iss</code>, <code>iat</code>, <code>cnf</code>, <code>email</code>, and <code>email_verified</code> claims from the payload<a href="#section-2.5-2.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.5-2.1.2.3">parsing the email domain from the <code>email</code> claim and looking up the <code>TXT</code> record for <code>_email-verification.$EMAIL_DOMAIN</code> to verify the <code>iss</code> claim matches the issuer identifier in the DNS record<a href="#section-2.5-2.1.2.3" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.5-2.1.2.4">fetching the issuer's public keys from the <code>jwks_uri</code> specified in the <code>.well-known/email-verification</code> file<a href="#section-2.5-2.1.2.4" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.5-2.1.2.5">verifying the EVT signature using the public key identified by <code>kid</code> from the JWKS with the <code>alg</code> algorithm<a href="#section-2.5-2.1.2.5" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.5-2.1.2.6">verifying the <code>iat</code> claim is within 60 seconds of the current time<a href="#section-2.5-2.1.2.6" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.5-2.1.2.7">verifying the <code>email</code> claim matches the email address being verified<a href="#section-2.5-2.1.2.7" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.5-2.1.2.8">verifying the <code>email_verified</code> claim is true<a href="#section-2.5-2.1.2.8" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.5-2.1.2.9">verifying the <code>cnf.jwk</code> claim matches the public key the browser generated in step 2.4<a href="#section-2.5-2.1.2.9" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-2.5-2.2">
            <p id="section-2.5-2.2.1"><strong>4.2</strong> - The browser then creates an EVT+KB by:<a href="#section-2.5-2.2.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="section-2.5-2.2.2.1">taking the verified EVT from step 4.1 as the base token<a href="#section-2.5-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.5-2.2.2.2">
                <p id="section-2.5-2.2.2.2.1">creating a Key Binding JWT (KB-JWT) with the following structure:<a href="#section-2.5-2.2.2.2.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="section-2.5-2.2.2.2.2.1">
                    <p id="section-2.5-2.2.2.2.2.1.1"><strong>Header</strong>:<a href="#section-2.5-2.2.2.2.2.1.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="section-2.5-2.2.2.2.2.1.2.1">
                        <code>alg</code>: same signing algorithm used by the browser's private key<a href="#section-2.5-2.2.2.2.2.1.2.1" class="pilcrow">¶</a>
</li>
                      <li class="compact normal" id="section-2.5-2.2.2.2.2.1.2.2">
                        <code>typ</code>: "kb+jwt"<a href="#section-2.5-2.2.2.2.2.1.2.2" class="pilcrow">¶</a>
</li>
                    </ul>
</li>
                  <li class="compact normal" id="section-2.5-2.2.2.2.2.2">
                    <p id="section-2.5-2.2.2.2.2.2.1"><strong>Payload</strong>:<a href="#section-2.5-2.2.2.2.2.2.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="section-2.5-2.2.2.2.2.2.2.1">
                        <code>aud</code>: the RP's origin<a href="#section-2.5-2.2.2.2.2.2.2.1" class="pilcrow">¶</a>
</li>
                      <li class="compact normal" id="section-2.5-2.2.2.2.2.2.2.2">
                        <code>nonce</code>: the nonce from step 1<a href="#section-2.5-2.2.2.2.2.2.2.2" class="pilcrow">¶</a>
</li>
                      <li class="compact normal" id="section-2.5-2.2.2.2.2.2.2.3">
                        <code>iat</code>: current time when creating the KB-JWT<a href="#section-2.5-2.2.2.2.2.2.2.3" class="pilcrow">¶</a>
</li>
                      <li class="compact normal" id="section-2.5-2.2.2.2.2.2.2.4">
                        <code>sd_hash</code>: SHA-256 hash of the EVT<a href="#section-2.5-2.2.2.2.2.2.2.4" class="pilcrow">¶</a>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact normal" id="section-2.5-2.2.2.3">signing the KB-JWT with the browser's private key (the same key pair generated in step 2.4)<a href="#section-2.5-2.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.5-2.2.2.4">concatenating the EVT and the KB-JWT separated by a tilde (~) to form the EVT+KB<a href="#section-2.5-2.2.2.4" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-2.5-3">Example KB-JWT header:<a href="#section-2.5-3" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-2.5-4">
<pre>  {
    "alg": "EdDSA",
    "typ": "kb+jwt"
  }

</pre><a href="#section-2.5-4" class="pilcrow">¶</a>
</div>
<p id="section-2.5-5">Example KB-JWT payload:<a href="#section-2.5-5" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-2.5-6">
<pre>  {
    "aud": "https://rp.example",
    "nonce": "259c5eae-486d-4b0f-b666-2a5b5ce1c925",
    "salt": "kR7fY9mP3xQ8wN2vL5jH6tZ1cB4nM9sD8fG3hJ7kL2p",
    "iat": 1724083260,
    "sd_hash": "X9yH0Ajrdm1Oij4tWso9UzzKJvPoDxwmuEcO3XAdRC0"
  }

</pre><a href="#section-2.5-6" class="pilcrow">¶</a>
</div>
<ul class="compact">
<li class="compact" id="section-2.5-7.1">
            <strong>4.3</strong> - The browser provides the EVT+KB to the RP (mechanism out of scope for this specification - see W3C browser API specification)<a href="#section-2.5-7.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="token-verification">
<section id="section-2.6">
        <h3 id="name-token-verification">
<a href="#section-2.6" class="section-number selfRef">2.6. </a><a href="#name-token-verification" class="section-name selfRef">Token Verification</a>
        </h3>
<p id="section-2.6-1">The RP receives the EVT+KB from the browser (mechanism out of scope) and the RP server MUST verify it by:<a href="#section-2.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.6-2.1">
            <p id="section-2.6-2.1.1"><strong>5.1</strong> - Parsing the EVT+KB by separating the EVT and KB-JWT components (separated by tilde ~)<a href="#section-2.6-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.6-2.2">
            <p id="section-2.6-2.2.1"><strong>5.2</strong> - Verifying the KB-JWT by:<a href="#section-2.6-2.2.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="section-2.6-2.2.2.1">parsing the KB-JWT into header, payload, and signature components<a href="#section-2.6-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.6-2.2.2.2">confirming the presence of, and extracting the <code>alg</code> field from the KB-JWT header, and the <code>aud</code>, <code>nonce</code>, <code>iat</code>, and <code>sd_hash</code> claims from the payload<a href="#section-2.6-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.6-2.2.2.3">verifying the <code>aud</code> claim matches the RP's origin<a href="#section-2.6-2.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.6-2.2.2.4">verifying the <code>nonce</code> claim matches the nonce from the RP's session (from step 1)<a href="#section-2.6-2.2.2.4" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.6-2.2.2.5">verifying the <code>iat</code> claim is within a reasonable time window<a href="#section-2.6-2.2.2.5" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.6-2.2.2.6">computing the SHA-256 hash of the EVT and verifying it matches the <code>sd_hash</code> claim<a href="#section-2.6-2.2.2.6" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-2.6-2.3">
            <p id="section-2.6-2.3.1"><strong>5.3</strong> - Verifying the EVT by:<a href="#section-2.6-2.3.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="section-2.6-2.3.2.1">parsing the EVT into header, payload, and signature components<a href="#section-2.6-2.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.6-2.3.2.2">confirming the presence of, and extracting the <code>alg</code> and <code>kid</code> fields from the EVT header, and the <code>iss</code>, <code>iat</code>, <code>cnf</code>, <code>email</code>, and <code>email_verified</code> claims from the payload<a href="#section-2.6-2.3.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.6-2.3.2.3">parsing the email domain from the <code>email</code> claim and looking up the <code>TXT</code> record for <code>_email-verification.$EMAIL_DOMAIN</code> to verify the <code>iss</code> claim matches the issuer identifier in the DNS record<a href="#section-2.6-2.3.2.3" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.6-2.3.2.4">fetching the issuer's public keys from the <code>jwks_uri</code> specified in the <code>.well-known/email-verification</code> file<a href="#section-2.6-2.3.2.4" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.6-2.3.2.5">verifying the EVT signature using the public key identified by <code>kid</code> from the JWKS with the <code>alg</code> algorithm<a href="#section-2.6-2.3.2.5" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.6-2.3.2.6">verifying the <code>iss</code> claim exactly matches the issuer identifier from the DNS record<a href="#section-2.6-2.3.2.6" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.6-2.3.2.7">verifying the <code>iat</code> claim is within a reasonable time window<a href="#section-2.6-2.3.2.7" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-2.6-2.3.2.8">verifying the <code>email_verified</code> claim is true<a href="#section-2.6-2.3.2.8" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-2.6-2.4">
            <p id="section-2.6-2.4.1"><strong>5.4</strong> - Verifying the KB-JWT signature using the public key from the <code>cnf</code> claim in the EVT with the <code>alg</code> algorithm from the KB-JWT header<a href="#section-2.6-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.6-2.5">
            <p id="section-2.6-2.5.1"><strong>5.5</strong> - If all verification steps pass, the RP has successfully verified that the user controls the email address in the <code>email</code> claim<a href="#section-2.6-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<blockquote id="section-2.6-3">
          <p id="section-2.6-3.1"><strong>Note</strong>: Standard SD-JWT libraries can be used to parse and validate EVTs, as EVTs use the same structure as SD-JWTs (JWT with <code>~</code> suffix).<a href="#section-2.6-3.1" class="pilcrow">¶</a></p>
</blockquote>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-3">
      <h2 id="name-privacy-considerations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<blockquote id="section-3-1">
        <p id="section-3-1.1">Below are notes capturing some discussions of potential privacy implications.<a href="#section-3-1.1" class="pilcrow">¶</a></p>
</blockquote>
<ol start="1" type="1" class="normal type-1" id="section-3-2">
<li id="section-3-2.1">
          <p id="section-3-2.1.1">The email domain operator no longer learns which applications the user is verifying their email address to as the applications are no longer sending an email verification code to the user. By using an EVT+KB, the browser intermediates the request and response so that the issuer does not learn the identity of the RP.<a href="#section-3-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.2">
          <p id="section-3-2.2.1">The RP can infer if a user is logged into the issuer as the RP receives an EVT when the user is logged in, and does not when the user is not logged in.<a href="#section-3-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.3">
          <p id="section-3-2.3.1">The issuer may learn the user has email at a mail domain it is authoritative for that it did not know the user had.<a href="#section-3-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ol>
</section>
</div>
<div id="security-considerations">
<section id="section-4">
      <h2 id="name-security-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="http-message-signature-security">
<section id="section-4.1">
        <h3 id="name-http-message-signature-secu">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-http-message-signature-secu" class="section-name selfRef">HTTP Message Signature Security</a>
        </h3>
<p id="section-4.1-1">The use of HTTP Message Signatures (<a href="https://datatracker.ietf.org/doc/html/rfc9421">RFC 9421</a>) provides several security benefits:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1-2">
<li id="section-4.1-2.1">
            <p id="section-4.1-2.1.1"><strong>Request Integrity</strong>: The signature covers the HTTP method, target URI, authority, content-digest, cookies, and security headers, preventing tampering with any of these components.<a href="#section-4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-2.2">
            <p id="section-4.1-2.2.1"><strong>Cookie Binding</strong>: By including the <code>cookie</code> component in the signature, the browser's authentication cookies are cryptographically bound to the specific request, preventing cookie injection or manipulation attacks.<a href="#section-4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-2.3">
            <p id="section-4.1-2.3.1"><strong>Replay Protection</strong>: The <code>created</code> timestamp in the <code>Signature-Input</code> header is verified to be within 60 seconds, preventing replay attacks.<a href="#section-4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-2.4">
            <p id="section-4.1-2.4.1"><strong>Public Key Binding</strong>: The browser's public key transmitted via the <code>Signature-Key</code> header with the <code>hwk</code> scheme is bound to the request signature, ensuring the issuer knows which public key to include in the EVT's <code>cnf</code> claim.<a href="#section-4.1-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="signature-key-hwk-scheme">
<section id="section-4.2">
        <h3 id="name-signature-key-hwk-scheme">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-signature-key-hwk-scheme" class="section-name selfRef">Signature-Key hwk Scheme</a>
        </h3>
<p id="section-4.2-1">The <code>hwk</code> (Header Web Key) scheme provides:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2-2">
<li id="section-4.2-2.1">
            <p id="section-4.2-2.1.1"><strong>Self-Contained Key Distribution</strong>: The public key is transmitted inline, eliminating the need for a separate key lookup or registration process.<a href="#section-4.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.2-2.2">
            <p id="section-4.2-2.2.1"><strong>Pseudonymity</strong>: The browser does not need to identify itself - the key serves as a pseudonymous identifier for the request.<a href="#section-4.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.2-2.3">
            <p id="section-4.2-2.3.1"><strong>Ephemeral Keys</strong>: The browser generates fresh key pairs for each verification flow, limiting the correlation potential across different verification attempts.<a href="#section-4.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="email-existence-probing">
<section id="section-4.3">
        <h3 id="name-email-existence-probing">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-email-existence-probing" class="section-name selfRef">Email Existence Probing</a>
        </h3>
<p id="section-4.3-1">A successful EVP verification confirms that an email address exists and is controlled by a logged-in user. This could potentially be used to:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-4.3-2">
<li id="section-4.3-2.1">
            <strong>Build email lists</strong>: An attacker could probe many addresses to identify valid ones for spam targeting.<a href="#section-4.3-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-2.2">
            <strong>Account enumeration</strong>: An attacker could determine which email addresses have accounts at specific issuers.<a href="#section-4.3-2.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-4.3-3">These risks are mitigated by:<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.3-4.1">
            <strong>User interaction required</strong>: The browser API requires user gesture and consent before initiating verification. Automated probing is not possible.<a href="#section-4.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.3-4.2">
            <strong>Rate limiting</strong>: Issuers can rate-limit requests per user session or IP address.<a href="#section-4.3-4.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.3-4.3">
            <strong>Same information as email OTP</strong>: An attacker can already determine email existence by sending verification emails and checking for bounces. EVP does not create new information disclosure.<a href="#section-4.3-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.3-5">Issuers should implement appropriate rate limiting and abuse detection.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="design-rationale">
<section id="section-5">
      <h2 id="name-design-rationale">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-design-rationale" class="section-name selfRef">Design Rationale</a>
      </h2>
<div id="why-not-solve-email-like-sms-otp">
<section id="section-5.1">
        <h3 id="name-why-not-solve-email-like-sm">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-why-not-solve-email-like-sm" class="section-name selfRef">Why Not Solve Email Like SMS OTP?</a>
        </h3>
<p id="section-5.1-1">The WebOTP API and <code>autocomplete="one-time-code"</code> standards dramatically reduced friction for SMS verification. A natural question is why email verification cannot use the same approach. Several fundamental differences make this impractical:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2"><strong>SMS is a mobile OS feature; email is application-layer</strong><a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">SMS is integrated into mobile operating systems. The OS receives incoming messages and can parse them before any application sees them. This privileged position enables the OS to recognize origin-bound OTP formats and offer autofill directly to the browser.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">Email operates at the application layer. There is no OS-level email subsystem that intercepts incoming messages. Email clients are ordinary applications—whether native apps, desktop programs, or web applications—with no special ability to coordinate with browsers for autofill.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5"><strong>SMS verification is mobile; email verification spans platforms</strong><a href="#section-5.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1-6">SMS OTP autofill works on mobile devices where the OS controls the messaging stack. Email verification happens on desktop computers, laptops, tablets, and phones. Any solution for email must work across all these platforms, not just mobile.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<p id="section-5.1-7"><strong>SMS senders are aggregators; email senders are RPs</strong><a href="#section-5.1-7" class="pilcrow">¶</a></p>
<p id="section-5.1-8">SMS verification messages are typically sent through aggregator services (Twilio, AWS SNS, etc.) that send on behalf of many relying parties. The "sender" of the SMS is often a short code or phone number shared across multiple services. This means the phone number or sender ID carries little identifying information about which RP sent the message.<a href="#section-5.1-8" class="pilcrow">¶</a></p>
<p id="section-5.1-9">Email verification messages come directly from the RP's domain. The sender address, domain, and email headers identify the RP. This architectural difference means that email verification inherently reveals more about the RP to the email provider than SMS verification reveals to the carrier.<a href="#section-5.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="why-the-three-party-model">
<section id="section-5.2">
        <h3 id="name-why-the-three-party-model">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-why-the-three-party-model" class="section-name selfRef">Why the Three-Party Model?</a>
        </h3>
<p id="section-5.2-1">A simpler design would have the issuer create a token directly for the RP, with the RP as the audience. This is how social login works: the identity provider knows which application the user is logging into.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">EVP uses a three-party model where the browser intermediates between the issuer and the RP. The issuer creates an EVT bound to the browser's ephemeral public key, and the browser creates a separate KB-JWT that binds the EVT to the RP. The issuer never learns the RP's identity.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">This design choice is driven by privacy: for users with domain-based email accounts (personal domains, work accounts), the email provider should not learn which applications the user accesses. The architectural complexity of the three-party model is justified by this privacy benefit.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="why-sd-jwt">
<section id="section-5.3">
        <h3 id="name-why-sd-jwt">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-why-sd-jwt" class="section-name selfRef">Why SD-JWT?</a>
        </h3>
<p id="section-5.3-1">The EVT uses the SD-JWT structure (specifically, the key binding capability from SD-JWT+KB) rather than a plain JWT. This choice provides:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.3-2">
<li id="section-5.3-2.1">
            <p id="section-5.3-2.1.1"><strong>Key Binding</strong>: The <code>~</code> separator and KB-JWT mechanism provide a standard way to bind a token to a holder's key, enabling the three-party model where issuance and presentation are separate operations.<a href="#section-5.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.3-2.2">
            <p id="section-5.3-2.2.1"><strong>Library Support</strong>: SD-JWT libraries already exist and can parse EVTs, reducing implementation burden for RPs.<a href="#section-5.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.3-2.3">
            <p id="section-5.3-2.3.1"><strong>Extensibility</strong>: While EVP does not currently use selective disclosure, the SD-JWT structure allows future extensions without changing the token format.<a href="#section-5.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="why-dns-delegation">
<section id="section-5.4">
        <h3 id="name-why-dns-delegation">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-why-dns-delegation" class="section-name selfRef">Why DNS Delegation?</a>
        </h3>
<p id="section-5.4-1">The mail domain delegates email verification to an issuer via a DNS TXT record rather than a <code>.well-known</code> file. This choice aligns with how email infrastructure already works:<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4-2">
<li id="section-5.4-2.1">
            <p id="section-5.4-2.1.1"><strong>Email domains often lack web hosting</strong>: Many users have personal domains used only for email. Requiring a web server to host a <code>.well-known</code> file would create a barrier to adoption.<a href="#section-5.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.4-2.2">
            <p id="section-5.4-2.2.1"><strong>Apex domain challenges</strong>: Email domains are typically apex domains (e.g., <code>example.com</code>), which do not support CNAME records. Hosting a web site on an apex domain requires additional infrastructure.<a href="#section-5.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.4-2.3">
            <p id="section-5.4-2.3.1"><strong>Familiar tooling</strong>: Domain owners already manage DNS records for email (MX, SPF, DKIM, DMARC). Adding another TXT record fits existing workflows.<a href="#section-5.4-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="why-jwks-over-dkim-keys">
<section id="section-5.5">
        <h3 id="name-why-jwks-over-dkim-keys">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-why-jwks-over-dkim-keys" class="section-name selfRef">Why JWKS Over DKIM Keys?</a>
        </h3>
<p id="section-5.5-1">The issuer publishes signing keys via a JWKS endpoint rather than reusing DKIM keys. While DKIM keys are already associated with email domains, JWKS provides practical advantages:<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5-2">
<li id="section-5.5-2.1">
            <p id="section-5.5-2.1.1"><strong>Key rotation</strong>: DKIM keys are rarely rotated in practice. JWKS rotation is common in OIDC deployments and follows established patterns.<a href="#section-5.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.5-2.2">
            <p id="section-5.5-2.2.1"><strong>Algorithm flexibility</strong>: JWKS supports multiple key types and algorithms. DKIM key distribution was designed for a specific use case.<a href="#section-5.5-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.5-2.3">
            <p id="section-5.5-2.3.1"><strong>Operational familiarity</strong>: Developers implementing EVP are likely familiar with JWKS from OAuth/OIDC work.<a href="#section-5.5-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="alternatives-under-consideration">
<section id="section-6">
      <h2 id="name-alternatives-under-consider">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-alternatives-under-consider" class="section-name selfRef">Alternatives Under Consideration</a>
      </h2>
<div id="passkey-authentication">
<section id="section-6.1">
        <h3 id="name-passkey-authentication">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-passkey-authentication" class="section-name selfRef">Passkey Authentication</a>
        </h3>
<p id="section-6.1-1">In addition to, or instead of the browser sending cookies to the Issuer, the Issuer could return a WebAuthN request to the browser if it has credentials for the user identified by the email address. The browser would then interact with the user and provide the WebAuthN response to the Issuer, authenticating the user, and the Issuer would then return the EVT.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="alternatives-considered">
<section id="section-7">
      <h2 id="name-alternatives-considered">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-alternatives-considered" class="section-name selfRef">Alternatives Considered</a>
      </h2>
<div id="use-wellknown-for-mail-domain-delegation-to-issuer">
<section id="section-7.1">
        <h3 id="name-use-wellknown-for-mail-doma">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-use-wellknown-for-mail-doma" class="section-name selfRef">Use .wellknown for Mail Domain delegation to Issuer</a>
        </h3>
<p id="section-7.1-1">Rather than the DNS TXT record, the Mail Domain would host a JSON file in the .wellknown domain. This creates challenges for the long tail of individually owned domains:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-7.1-2.1">would require a domain that is used just for email to now have to support a web server<a href="#section-7.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-7.1-2.2">the mail domain is usually an apex domain, which does not support CNAME, complicating hosting a web site<a href="#section-7.1-2.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="use-request-jwt-instead-of-http-message-signatures">
<section id="section-7.2">
        <h3 id="name-use-request-jwt-instead-of-">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-use-request-jwt-instead-of-" class="section-name selfRef">Use Request JWT Instead of HTTP Message Signatures</a>
        </h3>
<p id="section-7.2-1">The original design used a JWT signed by the browser to carry the email address and browser's public key. The HTTP Message Signatures approach was chosen because:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-7.2-2">
<li id="section-7.2-2.1">
            <strong>Standards-Based</strong>: RFC 9421 is a published standard for signing HTTP messages, providing better interoperability<a href="#section-7.2-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-7.2-2.2">
            <strong>Cookie Binding</strong>: HTTP Message Signatures can directly sign the <code>cookie</code> header, providing stronger binding between authentication cookies and the request<a href="#section-7.2-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-7.2-2.3">
            <strong>Content Integrity</strong>: The <code>content-digest</code> component provides built-in content integrity without needing to duplicate the email in a JWT<a href="#section-7.2-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-7.2-2.4">
            <strong>Flexibility</strong>: The signature can cover any HTTP components, making it easier to add additional protections in the future<a href="#section-7.2-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-7.2-2.5">
            <strong>Simpler Key Distribution</strong>: The Signature-Key header provides a standardized way to distribute keys inline with the request<a href="#section-7.2-2.5" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="references">
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<ul class="compact">
<li class="compact" id="section-8-1.1">
          <a href="https://datatracker.ietf.org/doc/html/rfc9421">RFC 9421: HTTP Message Signatures</a><a href="#section-8-1.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-8-1.2">
          <a href="https://datatracker.ietf.org/doc/html/rfc9530">RFC 9530: Digest Fields</a><a href="#section-8-1.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-8-1.3">
          <a href="https://datatracker.ietf.org/doc/draft-hardt-httpbis-signature-key/">draft-hardt-httpbis-signature-key: HTTP Signature-Key Header</a><a href="#section-8-1.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-8-1.4">
          <a href="https://datatracker.ietf.org/doc/draft-ietf-oauth-selective-disclosure-jwt/">Selective Disclosure for JWT (SD-JWT)</a><a href="#section-8-1.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-8-1.5">
          <a href="https://openid.net/specs/openid-connect-core-1_0.html">OpenID Connect Core 1.0</a><a href="#section-8-1.5" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
