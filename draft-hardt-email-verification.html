<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Email Verification Protocol</title>
<meta content="Dick Hardt" name="author">
<meta content="Sam Goto" name="author">
<meta content="
       This document defines the Email Verification Protocol (EVP), which enables web applications to verify that a user controls an email address without sending a verification email. The protocol uses a three-party model where the browser intermediates between the relying party and an issuer, providing both improved user experience and privacy protection. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="email" name="keyword">
<meta content="verification" name="keyword">
<meta content="identity" name="keyword">
<meta content="authentication" name="keyword">
<meta content="draft-hardt-email-verification-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.2.1
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.5.1
    pycountry 24.6.1
    PyYAML 6.0.3
    requests 2.32.5
    wcwidth 0.2.14
-->
<link href="draft-hardt-email-verification.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">EVP</td>
<td class="right">January 2026</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hardt &amp; Goto</td>
<td class="center">Expires 13 July 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">TBD</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-hardt-email-verification-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2026-01-09" class="published">9 January 2026</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-07-13">13 July 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Hardt</div>
<div class="org">Hellō</div>
</div>
<div class="author">
      <div class="author-name">S. Goto</div>
<div class="org">Google</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Email Verification Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines the Email Verification Protocol (EVP), which enables web applications to verify that a user controls an email address without sending a verification email. The protocol uses a three-party model where the browser intermediates between the relying party and an issuer, providing both improved user experience and privacy protection.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1"><em>Note: This section is to be removed before publishing as an RFC.</em><a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Source for this draft and an issue tracker can be found at <a href="https://github.com/dickhardt/email-verification">https://github.com/dickhardt/email-verification</a>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">The browser API aspects are being developed separately by the W3C (<span>[<a href="#EVP-Browser" class="cite xref">EVP-Browser</a>]</span>).<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 13 July 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2026 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-verification-friction" class="internal xref">Verification Friction</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-privacy-leakage" class="internal xref">Privacy Leakage</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-friction-solution" class="internal xref">Friction Solution</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-privacy-solution" class="internal xref">Privacy Solution</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-protocol-flow" class="internal xref">Protocol Flow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-session-binding" class="internal xref">Session Binding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-email-acquisition" class="internal xref">Email Acquisition</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-token-request" class="internal xref">Token Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-evt-issuance" class="internal xref">EVT Issuance</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="auto internal xref">2.5</a>.  <a href="#name-kb-creation" class="internal xref">KB Creation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a href="#section-2.6" class="auto internal xref">2.6</a>.  <a href="#name-token-presentation" class="internal xref">Token Presentation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.7">
                <p id="section-toc.1-1.2.2.7.1"><a href="#section-2.7" class="auto internal xref">2.7</a>.  <a href="#name-token-verification" class="internal xref">Token Verification</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-issuer-discovery" class="internal xref">Issuer Discovery</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-dns-delegation" class="internal xref">DNS Delegation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-issuer-metadata" class="internal xref">Issuer Metadata</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-http-message-signatures" class="internal xref">HTTP Message Signatures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-http-request-signing" class="internal xref">HTTP Request Signing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-request-body" class="internal xref">Request Body</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-signature-key-header" class="internal xref">Signature-Key Header</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="auto internal xref">4.1.3</a>.  <a href="#name-signature-input-header" class="internal xref">Signature-Input Header</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.4">
                    <p id="section-toc.1-1.4.2.1.2.4.1"><a href="#section-4.1.4" class="auto internal xref">4.1.4</a>.  <a href="#name-example-signed-request" class="internal xref">Example Signed Request</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-http-request-verification" class="internal xref">HTTP Request Verification</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-email-verification-token-ev" class="internal xref">Email Verification Token (EVT)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-evt-structure" class="internal xref">EVT Structure</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-header" class="internal xref">Header</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-payload" class="internal xref">Payload</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="auto internal xref">5.1.3</a>.  <a href="#name-format" class="internal xref">Format</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-evt-creation" class="internal xref">EVT Creation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-evt-verification" class="internal xref">EVT Verification</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-key-binding-evtkb" class="internal xref">Key Binding (EVT+KB)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-kb-jwt-structure" class="internal xref">KB-JWT Structure</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-header-2" class="internal xref">Header</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="auto internal xref">6.1.2</a>.  <a href="#name-payload-2" class="internal xref">Payload</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-evtkb-format" class="internal xref">EVT+KB Format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-sd-jwt-compatibility" class="internal xref">SD-JWT Compatibility</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-kb-jwt-creation" class="internal xref">KB-JWT Creation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-kb-jwt-verification" class="internal xref">KB-JWT Verification</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-webauthn-authentication" class="internal xref">WebAuthn Authentication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-webauthn-challenge-response" class="internal xref">WebAuthn Challenge Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-webauthn-response" class="internal xref">WebAuthn Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-webauthn-verification" class="internal xref">WebAuthn Verification</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-private-email-addresses" class="internal xref">Private Email Addresses</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-request-parameters" class="internal xref">Request Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-example-requests" class="internal xref">Example Requests</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-requirements" class="internal xref">Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-issuer-flexibility" class="internal xref">Issuer Flexibility</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-example-evt-payload" class="internal xref">Example EVT Payload</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-error-responses" class="internal xref">Error Responses</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-invalid-content-type-header" class="internal xref">Invalid Content-Type Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-invalid-sec-fetch-dest-head" class="internal xref">Invalid Sec-Fetch-Dest Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-invalid-or-missing-http-mes" class="internal xref">Invalid or Missing HTTP Message Signature</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="auto internal xref">9.4</a>.  <a href="#name-invalid-content-digest" class="internal xref">Invalid Content-Digest</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5" class="auto internal xref">9.5</a>.  <a href="#name-authentication-required" class="internal xref">Authentication Required</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a href="#section-9.6" class="auto internal xref">9.6</a>.  <a href="#name-invalid-parameters" class="internal xref">Invalid Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.7">
                <p id="section-toc.1-1.9.2.7.1"><a href="#section-9.7" class="auto internal xref">9.7</a>.  <a href="#name-private-email-not-supported" class="internal xref">Private Email Not Supported</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.8">
                <p id="section-toc.1-1.9.2.8.1"><a href="#section-9.8" class="auto internal xref">9.8</a>.  <a href="#name-invalid-directed-email" class="internal xref">Invalid Directed Email</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.9">
                <p id="section-toc.1-1.9.2.9.1"><a href="#section-9.9" class="auto internal xref">9.9</a>.  <a href="#name-server-errors" class="internal xref">Server Errors</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-reduced-friction-tradeoff" class="internal xref">Reduced Friction Tradeoff</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-timing-correlation-by-email" class="internal xref">Timing Correlation by Email Providers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-rp-correlation-via-email-ad" class="internal xref">RP Correlation via Email Addresses</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="auto internal xref">10.4</a>.  <a href="#name-issuer-knowledge" class="internal xref">Issuer Knowledge</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#section-10.5" class="auto internal xref">10.5</a>.  <a href="#name-rp-knowledge" class="internal xref">RP Knowledge</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.6">
                <p id="section-toc.1-1.10.2.6.1"><a href="#section-10.6" class="auto internal xref">10.6</a>.  <a href="#name-browser-storage" class="internal xref">Browser Storage</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-http-message-signature-secu" class="internal xref">HTTP Message Signature Security</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-signature-key-hwk-scheme" class="internal xref">Signature-Key hwk Scheme</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="auto internal xref">11.3</a>.  <a href="#name-email-existence-probing" class="internal xref">Email Existence Probing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3.2.1">
                    <p id="section-toc.1-1.11.2.3.2.1.1"><a href="#section-11.3.1" class="auto internal xref">11.3.1</a>.  <a href="#name-uniform-error-responses" class="internal xref">Uniform Error Responses</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3.2.2">
                    <p id="section-toc.1-1.11.2.3.2.2.1"><a href="#section-11.3.2" class="auto internal xref">11.3.2</a>.  <a href="#name-timing-attack-mitigations" class="internal xref">Timing Attack Mitigations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3.2.3">
                    <p id="section-toc.1-1.11.2.3.2.3.1"><a href="#section-11.3.3" class="auto internal xref">11.3.3</a>.  <a href="#name-additional-mitigations" class="internal xref">Additional Mitigations</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-design-rationale" class="internal xref">Design Rationale</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-why-not-solve-email-like-sm" class="internal xref">Why Not Solve Email Like SMS OTP?</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-why-the-three-party-model" class="internal xref">Why the Three-Party Model?</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="auto internal xref">12.3</a>.  <a href="#name-why-sd-jwt" class="internal xref">Why SD-JWT?</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#section-12.4" class="auto internal xref">12.4</a>.  <a href="#name-why-dns-delegation" class="internal xref">Why DNS Delegation?</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a href="#section-12.5" class="auto internal xref">12.5</a>.  <a href="#name-why-jwks-over-dkim-keys" class="internal xref">Why JWKS Over DKIM Keys?</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.6">
                <p id="section-toc.1-1.12.2.6.1"><a href="#section-12.6" class="auto internal xref">12.6</a>.  <a href="#name-why-http-message-signatures" class="internal xref">Why HTTP Message Signatures Rather Than Request JWT?</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Web applications verify email addresses to send emails to users (transactional notifications, marketing, password resets) and to identify users (as a stable identifier for account creation and authentication). The standard verification method—sending a one-time code via email—has two problems: verification friction and privacy leakage.<a href="#section-1-1" class="pilcrow">¶</a></p>
<div id="verification-friction">
<section id="section-1.1">
        <h3 id="name-verification-friction">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-verification-friction" class="section-name selfRef">Verification Friction</a>
        </h3>
<p id="section-1.1-1">The email one-time code flow requires the user to switch to their email client, wait for the message to arrive, find it (possibly in spam), read the code, return to the application, and enter it. Many users abandon this process before completing it.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Some approaches to reduce this friction:<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.1">
            <p id="section-1.1-3.1.1"><strong>Social login</strong>: When a user has an account with Google, Apple, or another identity provider, the application can obtain a verified email without sending a verification message. However, this requires the user to have and use a social account, and requires developers to integrate with each provider separately.<a href="#section-1.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-3.2">
            <p id="section-1.1-3.2.1"><strong>Magic links</strong>: Instead of a code, the verification email contains a link the user clicks to verify. This eliminates copying and pasting the code, but still requires switching to the email client, waiting for delivery, and finding the email.<a href="#section-1.1-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="privacy-leakage">
<section id="section-1.2">
        <h3 id="name-privacy-leakage">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-privacy-leakage" class="section-name selfRef">Privacy Leakage</a>
        </h3>
<p id="section-1.2-1">Email verification creates two privacy problems:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.2-2">
<li id="section-1.2-2.1">
            <p id="section-1.2-2.1.1"><strong>RP-to-RP correlation</strong>: When a user provides their real email address to multiple relying parties (RPs), those RPs can correlate the user across sites by comparing email addresses.<a href="#section-1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-2.2">
            <p id="section-1.2-2.2.1"><strong>User-RP visibility</strong>: The email provider learns which RPs the user visits and when. With email OTP, the provider sees verification emails from the sender and the delivery timing for every verification. With social login, the identity provider sees every RP request.<a href="#section-1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-1.2-3">Reducing friction in email verification accelerates both privacy problems — users verify to more sites, increasing correlation potential and provider visibility.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="friction-solution">
<section id="section-1.3">
        <h3 id="name-friction-solution">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-friction-solution" class="section-name selfRef">Friction Solution</a>
        </h3>
<p id="section-1.3-1">The Email Verification Protocol (EVP) enables a web application to obtain a verified email address <strong>without sending an email</strong> and <strong>without the user leaving the web page</strong>. The browser intermediates between the RP and an issuer, obtaining a signed token that contains an email address for the user that the RP can verify. This eliminates the email delivery step entirely.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2"><strong>Note on deliverability</strong>: Like social login, this protocol verifies that the user controls an email address — it does not verify that the email address can receive mail.<a href="#section-1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-solution">
<section id="section-1.4">
        <h3 id="name-privacy-solution">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-privacy-solution" class="section-name selfRef">Privacy Solution</a>
        </h3>
<p id="section-1.4-1">EVP addresses both privacy problems:<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<p id="section-1.4-2"><strong>Three-party model</strong>: The browser intermediates between the RP and issuer, ensuring the issuer never learns which RP requested verification. See <a href="#protocol-flow">Protocol Flow</a> for details.<a href="#section-1.4-2" class="pilcrow">¶</a></p>
<p id="section-1.4-3"><strong>Private email addresses</strong>: The browser can request a private email address instead of the user's actual email. Private addresses that differ per RP cannot be correlated across sites. See <a href="#private-email">Private Email Addresses</a> for details.<a href="#section-1.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="protocol-flow">
<section id="section-2">
      <h2 id="name-protocol-flow">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-protocol-flow" class="section-name selfRef">Protocol Flow</a>
      </h2>
<p id="section-2-1">This document specifies the IETF protocol aspects of email verification: the HTTP-level interactions between the browser, issuer, and the application, aka relying party (RP). How the browser obtains the email address from the user (browser APIs, user interface elements, etc.) and how the browser communicates with the RP is being defined by the W3C (<span>[<a href="#EVP-Browser" class="cite xref">EVP-Browser</a>]</span>).<a href="#section-2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-2.1">
          <p id="section-2-2.1.1"><strong>Issuer</strong>: The service that verifies the user controls an email address. See <a href="#issuer-discovery">Issuer Discovery</a> for how email domains delegate to issuers.<a href="#section-2-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-2.2">
          <p id="section-2-2.2.1"><strong>Three-party model</strong>: The protocol uses a three-party model where the browser intermediates between the RP and issuer. The issuer issues a email verification token (EVT) to the browser containing the email address and the browser's key material—but not the RP identity. The browser then creates a key binding token (KB-JWT) that ties the EVT to a specific RP. The combined token (EVT+KB) is what the RP receives. This separation hides the RP from the issuer during verification.<a href="#section-2-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-3">The following diagram illustrates the protocol flow between the RP Server, Browser, and Issuer:<a href="#section-2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2-4">
<pre>Step                      RP Server     Browser              Issuer
                               |            |                    |
2.1 Session Binding            |--- nonce -&gt;|                    |
                               |            |                    |
2.2 Email Acquisition          |      [obtain email from user]   |
                               |            |                    |
2.3 Token Request              |            |-- POST /issuance -&gt;|
                               |            |    (email, ...)    |
                               |            |                    |
2.4 EVT Creation               |            |           [create EVT]
                               |            |                    |
2.5 Token Issuance             |            |&lt;------ EVT --------|
                               |            |                    |
2.6 KB Creation                |        [create KB-JWT]          |
                               |            |                    |
2.7 Token Presentation         |&lt;-- EVT+KB -|                    |
                               |            |                    |
2.8 Token Verification    [verify EVT+KB]   |                    |
                               |            |                    |

</pre><a href="#section-2-4" class="pilcrow">¶</a>
</div>
<div id="session-binding">
<section id="section-2.1">
        <h3 id="name-session-binding">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-session-binding" class="section-name selfRef">Session Binding</a>
        </h3>
<p id="section-2.1-1">The RP Server generates a cryptographically random nonce with at least 128 bits of entropy and binds it to a session it has with the browser. The nonce MUST be unique per verification request and SHOULD be valid for a limited time window. How the RP Server provides the nonce to the browser is being defined by the W3C (<span>[<a href="#EVP-Browser" class="cite xref">EVP-Browser</a>]</span>).<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="email-acquisition">
<section id="section-2.2">
        <h3 id="name-email-acquisition">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-email-acquisition" class="section-name selfRef">Email Acquisition</a>
        </h3>
<p id="section-2.2-1">The browser obtains an email address from the user. This mechanism is being defined by the W3C (<span>[<a href="#EVP-Browser" class="cite xref">EVP-Browser</a>]</span>).<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-request">
<section id="section-2.3">
        <h3 id="name-token-request">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-token-request" class="section-name selfRef">Token Request</a>
        </h3>
<p id="section-2.3-1">Once the browser has the email address and nonce:<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3-2">
<li id="section-2.3-2.1">
            <p id="section-2.3-2.1.1">The browser performs <a href="#issuer-discovery">Issuer Discovery</a> for the email address to obtain the issuer's metadata, including the <code>issuance_endpoint</code>.<a href="#section-2.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-2.3-2.2">
            <p id="section-2.3-2.2.1">The browser generates a fresh private/public key pair. The browser SHOULD select an algorithm from the issuer's <code>signing_alg_values_supported</code> array, or use "EdDSA" if not present.<a href="#section-2.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-2.3-2.3">
            <p id="section-2.3-2.3.1">The browser creates a signed request per <a href="#http-signatures">HTTP Message Signatures</a> and POSTs to the <code>issuance_endpoint</code>, including the issuer's cookies. The request body is a JSON object with the following parameters:<a href="#section-2.3-2.3.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-2.3-2.3.2.1">
                <code>email</code> (REQUIRED): The email address to verify<a href="#section-2.3-2.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-2.3-2.3.2.2">See <a href="#private-email">Private Email Addresses</a> for parameters to request private email addresses<a href="#section-2.3-2.3.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-2.3-2.3.2.3">See <a href="#webauthn-authentication">WebAuthn Authentication</a> for parameters to respond to a WebAuthn challenge<a href="#section-2.3-2.3.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ol>
<div class="lang-http sourcecode" id="section-2.3-3">
<pre>POST /email-verification/issuance HTTP/1.1
Host: accounts.issuer.example
Cookie: session=...
Content-Type: application/json
Content-Digest: sha-256=:X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=:
Sec-Fetch-Dest: email-verification
Signature-Input: sig=("@method" "@authority" "@path" \
    "content-digest" "cookie" "signature-key");created=1692345600
Signature: sig=:MEQCIHd8Y8qYKm5e3dV8y....:
Signature-Key: sig=hwk; kty="OKP"; crv="Ed25519"; \
    x="JrQLj5P_89iXES9-vFgrIy29clF9CC_oPPsw3c5D0bs"

{"email":"user@example.com"}

</pre><a href="#section-2.3-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="evt-issuance">
<section id="section-2.4">
        <h3 id="name-evt-issuance">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-evt-issuance" class="section-name selfRef">EVT Issuance</a>
        </h3>
<p id="section-2.4-1">On receipt of a token request:<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.4-2">
<li id="section-2.4-2.1">
            <p id="section-2.4-2.1.1">The issuer verifies the request per <a href="#request-verification">Request Verification</a>.<a href="#section-2.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-2.4-2.2">
            <p id="section-2.4-2.2.1">The issuer checks if the cookies represent a logged-in user who controls the requested email address. If the issuer supports WebAuthn (<code>webauthn_supported: true</code>) and cookies are not present or invalid, the issuer MAY return a WebAuthn challenge (see <a href="#webauthn-authentication">WebAuthn Authentication</a>).<a href="#section-2.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-2.4-2.3">
            <p id="section-2.4-2.3.1">If authentication succeeds, the issuer creates an EVT per <a href="#evt-creation">EVT Creation</a> and returns it as the value of <code>issuance_token</code> in an <code>application/json</code> response. The issuer MAY include <code>Set-Cookie</code> headers to establish or update session state:<a href="#section-2.4-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<div class="lang-http sourcecode" id="section-2.4-3">
<pre>HTTP/1.1 200 OK
Content-Type: application/json
Set-Cookie: session=...; Secure; HttpOnly; SameSite=None

{"issuance_token":"eyJhbGciOiJFZERTQSIsImtpZCI6IjIwMjQtMDgtMTkiLCJ0eXAiOiJldnQrand0In0...~"}

</pre><a href="#section-2.4-3" class="pilcrow">¶</a>
</div>
<p id="section-2.4-4">The browser MUST process any <code>Set-Cookie</code> headers in the response.<a href="#section-2.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="kb-creation">
<section id="section-2.5">
        <h3 id="name-kb-creation">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-kb-creation" class="section-name selfRef">KB Creation</a>
        </h3>
<p id="section-2.5-1">On receiving the <code>issuance_token</code>:<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.5-2">
<li id="section-2.5-2.1">
            <p id="section-2.5-2.1.1">The browser verifies the EVT per <a href="#evt-verification">EVT Verification</a>, additionally confirming:<a href="#section-2.5-2.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-2.5-2.1.2.1">The <code>email</code> claim matches the email address being verified<a href="#section-2.5-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-2.5-2.1.2.2">The <code>cnf.jwk</code> claim matches the public key the browser generated<a href="#section-2.5-2.1.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-2.5-2.2">
            <p id="section-2.5-2.2.1">The browser creates a KB-JWT per <a href="#kb-creation-detail">KB-JWT Creation</a>, binding the EVT to the RP's origin and session nonce.<a href="#section-2.5-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-2.5-2.3">
            <p id="section-2.5-2.3.1">The browser concatenates the EVT and KB-JWT to form the EVT+KB.<a href="#section-2.5-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-2.5-3">Example EVT+KB (line breaks for display):<a href="#section-2.5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.5-4">
<pre>eyJhbGciOiJFZERTQSIsImtpZCI6IjIwMjQtMDgtMTkiLCJ0eXAiOiJldnQrand0In0.
eyJpc3MiOiJpc3N1ZXIuZXhhbXBsZSIsImlhdCI6MTcyNDA4MzIwMCwiY25mIjp7...}.
signature~
eyJhbGciOiJFZERTQSIsInR5cCI6ImtiK2p3dCJ9.
eyJhdWQiOiJodHRwczovL3JwLmV4YW1wbGUiLCJub25jZSI6IjI1OWM1ZWFlLTQ4...}.
signature

</pre><a href="#section-2.5-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="token-presentation">
<section id="section-2.6">
        <h3 id="name-token-presentation">
<a href="#section-2.6" class="section-number selfRef">2.6. </a><a href="#name-token-presentation" class="section-name selfRef">Token Presentation</a>
        </h3>
<p id="section-2.6-1">The browser provides the EVT+KB to the RP. This mechanism is being defined by the W3C (<span>[<a href="#EVP-Browser" class="cite xref">EVP-Browser</a>]</span>).<a href="#section-2.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-verification">
<section id="section-2.7">
        <h3 id="name-token-verification">
<a href="#section-2.7" class="section-number selfRef">2.7. </a><a href="#name-token-verification" class="section-name selfRef">Token Verification</a>
        </h3>
<p id="section-2.7-1">The RP receives the EVT+KB and verifies it by:<a href="#section-2.7-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-2.7-2">
<li id="section-2.7-2.1">Verifying the KB-JWT per <a href="#kb-verification">KB-JWT Verification</a><a href="#section-2.7-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.7-2.2">Verifying the EVT per <a href="#evt-verification">EVT Verification</a><a href="#section-2.7-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.7-2.3">Verifying the KB-JWT signature using the public key from the EVT's <code>cnf.jwk</code> claim<a href="#section-2.7-2.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-2.7-3">If all verification steps pass, the RP has successfully verified that the user controls the email address in the <code>email</code> claim.<a href="#section-2.7-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="issuer-discovery">
<section id="section-3">
      <h2 id="name-issuer-discovery">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-issuer-discovery" class="section-name selfRef">Issuer Discovery</a>
      </h2>
<p id="section-3-1">Both the browser and the RP need to discover information about the issuer for a given email address. This section describes the discovery process.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="dns-delegation">
<section id="section-3.1">
        <h3 id="name-dns-delegation">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-dns-delegation" class="section-name selfRef">DNS Delegation</a>
        </h3>
<p id="section-3.1-1">The email domain delegates email verification to an issuer via a DNS TXT record. Given an email address, parse the email domain (<code>EMAIL_DOMAIN) and look up the `TXT` record for `_email-verification.</code>EMAIL_DOMAIN<code>. The contents of the record MUST start with</code>iss=<code>followed by the issuer identifier. There MUST be only one</code>TXT<code>record for</code>_email-verification.$EMAIL_DOMAIN`.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Example record:<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<div class="lang-bash sourcecode" id="section-3.1-3">
<pre>_email-verification.email-domain.example   TXT   iss=issuer.example

</pre><a href="#section-3.1-3" class="pilcrow">¶</a>
</div>
<p id="section-3.1-4">This record states that <code>email-domain.example</code> has delegated email verification to the issuer <code>issuer.example</code>.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">If the email domain and the issuer are the same domain, then the record would be:<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<div class="lang-bash sourcecode" id="section-3.1-6">
<pre>_email-verification.issuer.example   TXT   iss=issuer.example

</pre><a href="#section-3.1-6" class="pilcrow">¶</a>
</div>
<blockquote id="section-3.1-7">
          <p id="section-3.1-7.1">Access to DNS records and email is often independent of website deployments. This provides assurance that an issuer is truly authorized as an insider with only access to websites on <code>issuer.example</code> could not setup an issuer that would grant them verified emails for any email at <code>issuer.example</code>.<a href="#section-3.1-7.1" class="pilcrow">¶</a></p>
</blockquote>
</section>
</div>
<div id="issuer-metadata">
<section id="section-3.2">
        <h3 id="name-issuer-metadata">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-issuer-metadata" class="section-name selfRef">Issuer Metadata</a>
        </h3>
<p id="section-3.2-1">Once the issuer identifier is known, fetch the metadata document from <code>https://$ISSUER/.well-known/email-verification</code>. The request MUST follow redirects to the same path but with a different subdomain of the Issuer.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">For example, <code>https://issuer.example/.well-known/email-verification</code> may redirect to <code>https://accounts.issuer.example/.well-known/email-verification</code>.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">The metadata document is JSON containing the following properties:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2-4.1">
            <em>issuance_endpoint</em> - the API endpoint the browser calls to obtain an EVT<a href="#section-3.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.2-4.2">
            <em>jwks_uri</em> - the URL where the issuer provides its public keys to verify the EVT<a href="#section-3.2-4.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.2-4.3">
            <em>signing_alg_values_supported</em> - OPTIONAL. JSON array containing a list of the signing algorithms ("alg" values) supported by the issuer for both HTTP Message Signatures and issued EVTs. Algorithm identifiers MUST be from the IANA "JSON Web Signature and Encryption Algorithms" registry. If omitted, "EdDSA" is the default. "EdDSA" SHOULD be included in the supported algorithms list. The value "none" MUST NOT be used.<a href="#section-3.2-4.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.2-4.4">
            <em>webauthn_supported</em> - OPTIONAL. Boolean indicating whether the issuer supports WebAuthn authentication as an alternative to cookies. If <code>true</code>, the issuer may return a WebAuthn challenge when cookies are not present or invalid. Defaults to <code>false</code>.<a href="#section-3.2-4.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.2-4.5">
            <em>private_email_supported</em> - OPTIONAL. Boolean indicating whether the issuer supports generating private email addresses. Defaults to <code>false</code>.<a href="#section-3.2-4.5" class="pilcrow">¶</a>
</li>
        </ul>
<blockquote id="section-3.2-5">
          <p id="section-3.2-5.1"><strong>Open Question</strong>: Should URL properties be required to include the issuer domain as the root of their hostname?<a href="#section-3.2-5.1" class="pilcrow">¶</a></p>
</blockquote>
<p id="section-3.2-6">Following is an example <code>.well-known/email-verification</code> file:<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-3.2-7">
<pre>{
  "issuance_endpoint": "https://accounts.issuer.example/email-verification/issuance",
  "jwks_uri": "https://accounts.issuer.example/email-verification/jwks",
  "signing_alg_values_supported": ["EdDSA", "RS256"],
  "webauthn_supported": true,
  "private_email_supported": true
}

</pre><a href="#section-3.2-7" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="http-signatures">
<section id="section-4">
      <h2 id="name-http-message-signatures">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-http-message-signatures" class="section-name selfRef">HTTP Message Signatures</a>
      </h2>
<p id="section-4-1">This section defines how HTTP Message Signatures (<span>[<a href="#RFC9421" class="cite xref">RFC9421</a>]</span>) are used in token requests. The browser signs requests to prove possession of a key pair, and the issuer verifies these signatures.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="request-signing">
<section id="section-4.1">
        <h3 id="name-http-request-signing">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-http-request-signing" class="section-name selfRef">HTTP Request Signing</a>
        </h3>
<p id="section-4.1-1">The browser creates a signed request by:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-4.1-2">
<li id="section-4.1-2.1">Creating a JSON request body with the email address and optional parameters<a href="#section-4.1-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-2.2">Computing the <code>Content-Digest</code> header per <span>[<a href="#RFC9530" class="cite xref">RFC9530</a>]</span> using SHA-256<a href="#section-4.1-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-2.3">Creating the <code>Signature-Key</code> header using the <code>hwk</code> scheme (<span>[<a href="#I-D.hardt-httpbis-signature-key" class="cite xref">I-D.hardt-httpbis-signature-key</a>]</span>) with the browser's public key<a href="#section-4.1-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-2.4">Creating the <code>Signature-Input</code> header specifying the covered components<a href="#section-4.1-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-2.5">Computing the signature base per <span>[<a href="#RFC9421" class="cite xref">RFC9421</a>]</span> Section 2.5 and signing with the browser's private key<a href="#section-4.1-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-2.6">Creating the <code>Signature</code> header with the base64-encoded signature<a href="#section-4.1-2.6" class="pilcrow">¶</a>
</li>
        </ol>
<div id="request-body">
<section id="section-4.1.1">
          <h4 id="name-request-body">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-request-body" class="section-name selfRef">Request Body</a>
          </h4>
<p id="section-4.1.1-1">The request body is a JSON object with the following fields:<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1.1-2.1">
              <code>email</code> (REQUIRED): The email address to verify<a href="#section-4.1.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.1.1-2.2">
              <code>private_email</code> (OPTIONAL): Request a new private email address. See <a href="#private-email">Private Email Addresses</a>.<a href="#section-4.1.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.1.1-2.3">
              <code>directed_email</code> (OPTIONAL): A previously issued private email address to reuse. See <a href="#private-email">Private Email Addresses</a>.<a href="#section-4.1.1-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.1.1-3">Example:<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-4.1.1-4">
<pre>{
  "email": "user@example.com"
}

</pre><a href="#section-4.1.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="signature-key-header">
<section id="section-4.1.2">
          <h4 id="name-signature-key-header">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-signature-key-header" class="section-name selfRef">Signature-Key Header</a>
          </h4>
<p id="section-4.1.2-1">The <code>Signature-Key</code> header uses the <code>hwk</code> scheme to convey the browser's public key:<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.2-2">
<pre>Signature-Key: sig=hwk; kty="OKP"; crv="Ed25519"; \
    x="JrQLj5P_89iXES9-vFgrIy29clF9CC_oPPsw3c5D0bs"

</pre><a href="#section-4.1.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="signature-input-header">
<section id="section-4.1.3">
          <h4 id="name-signature-input-header">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-signature-input-header" class="section-name selfRef">Signature-Input Header</a>
          </h4>
<p id="section-4.1.3-1">The covered components MUST include <code>@method</code>, <code>@authority</code>, <code>@path</code>, <code>content-digest</code>, and <code>signature-key</code>. The <code>cookie</code> component MUST be included when the Cookie header is present, and MUST be omitted when it is not (per <span>[<a href="#RFC9421" class="cite xref">RFC9421</a>]</span> Section 2.5). The <code>created</code> parameter MUST be included.<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.3-2">
<pre>Signature-Input: sig=("@method" "@authority" "@path" \
    "content-digest" "cookie" "signature-key");created=1692345600

</pre><a href="#section-4.1.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-signed-request">
<section id="section-4.1.4">
          <h4 id="name-example-signed-request">
<a href="#section-4.1.4" class="section-number selfRef">4.1.4. </a><a href="#name-example-signed-request" class="section-name selfRef">Example Signed Request</a>
          </h4>
<div class="lang-http sourcecode" id="section-4.1.4-1">
<pre>POST /email-verification/issuance HTTP/1.1
Host: accounts.issuer.example
Cookie: session=...
Content-Type: application/json
Content-Digest: sha-256=:X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=:
Sec-Fetch-Dest: email-verification
Signature-Input: sig=("@method" "@authority" "@path" \
    "content-digest" "cookie" "signature-key");created=1692345600
Signature: sig=:MEQCIHd8Y8qYKm5e3dV8y....:
Signature-Key: sig=hwk; kty="OKP"; crv="Ed25519"; \
    x="JrQLj5P_89iXES9-vFgrIy29clF9CC_oPPsw3c5D0bs"

{"email":"user@example.com"}

</pre><a href="#section-4.1.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="request-verification">
<section id="section-4.2">
        <h3 id="name-http-request-verification">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-http-request-verification" class="section-name selfRef">HTTP Request Verification</a>
        </h3>
<p id="section-4.2-1">The issuer MUST verify the request headers:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.2-2.1">
            <code>Content-Type</code> is <code>application/json</code><a href="#section-4.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.2-2.2">
            <code>Sec-Fetch-Dest</code> is <code>email-verification</code><a href="#section-4.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.2-2.3">
            <code>Content-Digest</code> is present<a href="#section-4.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.2-2.4">
            <code>Signature-Input</code> is present<a href="#section-4.2-2.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.2-2.5">
            <code>Signature</code> is present<a href="#section-4.2-2.5" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.2-2.6">
            <code>Signature-Key</code> is present with <code>sig=hwk</code> scheme<a href="#section-4.2-2.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-3">The issuer MUST verify the HTTP Message Signature by:<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-4.2-4">
<li id="section-4.2-4.1">Parsing the <code>Signature-Key</code> header and extracting the public key from the <code>hwk</code> parameters (<code>kty</code>, <code>crv</code>, <code>x</code> for OKP keys)<a href="#section-4.2-4.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.2-4.2">Parsing the <code>Signature-Input</code> header to determine the covered components<a href="#section-4.2-4.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.2-4.3">Verifying that the signature covers at minimum: <code>@method</code>, <code>@authority</code>, <code>@path</code>, <code>content-digest</code>, and <code>signature-key</code>. The signature MUST also cover <code>cookie</code> when the Cookie header is present.<a href="#section-4.2-4.3" class="pilcrow">¶</a>
</li>
          <li id="section-4.2-4.4">Reconstructing the signature base per <span>[<a href="#RFC9421" class="cite xref">RFC9421</a>]</span> Section 2.5<a href="#section-4.2-4.4" class="pilcrow">¶</a>
</li>
          <li id="section-4.2-4.5">Verifying the signature in the <code>Signature</code> header using the extracted public key<a href="#section-4.2-4.5" class="pilcrow">¶</a>
</li>
          <li id="section-4.2-4.6">Verifying the <code>created</code> timestamp in <code>Signature-Input</code> is within 60 seconds of the current time<a href="#section-4.2-4.6" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-4.2-5">The issuer MUST verify the request body:<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-4.2-6">
<li id="section-4.2-6.1">Parsing the JSON body and extracting the <code>email</code> field<a href="#section-4.2-6.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.2-6.2">Verifying the <code>email</code> field contains a syntactically valid email address<a href="#section-4.2-6.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.2-6.3">Verifying the <code>Content-Digest</code> matches the actual request body<a href="#section-4.2-6.3" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="evt">
<section id="section-5">
      <h2 id="name-email-verification-token-ev">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-email-verification-token-ev" class="section-name selfRef">Email Verification Token (EVT)</a>
      </h2>
<p id="section-5-1">The Email Verification Token (EVT) is a JWT issued by the issuer that contains a verified email address and the browser's public key. This section defines the EVT structure and how it is created and verified.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="evt-structure">
<section id="section-5.1">
        <h3 id="name-evt-structure">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-evt-structure" class="section-name selfRef">EVT Structure</a>
        </h3>
<p id="section-5.1-1">The EVT is a JWT with the following structure:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div id="header">
<section id="section-5.1.1">
          <h4 id="name-header">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-header" class="section-name selfRef">Header</a>
          </h4>
<ul class="compact">
<li class="compact" id="section-5.1.1-1.1">
              <code>alg</code> (REQUIRED): Signing algorithm<a href="#section-5.1.1-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.1.1-1.2">
              <code>kid</code> (REQUIRED): Key identifier of the key used to sign<a href="#section-5.1.1-1.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.1.1-1.3">
              <code>typ</code> (REQUIRED): Set to "evt+jwt"<a href="#section-5.1.1-1.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.1.1-2">Example:<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-5.1.1-3">
<pre>{
  "alg": "EdDSA",
  "kid": "2024-08-19",
  "typ": "evt+jwt"
}

</pre><a href="#section-5.1.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="payload">
<section id="section-5.1.2">
          <h4 id="name-payload">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-payload" class="section-name selfRef">Payload</a>
          </h4>
<p id="section-5.1.2-1">Required claims:<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.1.2-2.1">
              <code>iss</code>: The issuer identifier<a href="#section-5.1.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.1.2-2.2">
              <code>iat</code>: Issued at time (seconds since epoch)<a href="#section-5.1.2-2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.1.2-2.3">
              <code>cnf</code>: Confirmation claim containing the browser's public key in <code>jwk</code> format (for SD-JWT Key Binding compatibility)<a href="#section-5.1.2-2.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.1.2-2.4">
              <code>email</code>: The verified email address<a href="#section-5.1.2-2.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.1.2-2.5">
              <code>email_verified</code>: Boolean, MUST be <code>true</code><a href="#section-5.1.2-2.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.1.2-3">Optional claims:<a href="#section-5.1.2-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.1.2-4.1">
              <code>is_private_email</code>: Boolean, set to <code>true</code> when the email is a private address<a href="#section-5.1.2-4.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.1.2-5">Example:<a href="#section-5.1.2-5" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-5.1.2-6">
<pre>{
  "iss": "issuer.example",
  "iat": 1724083200,
  "cnf": {
    "jwk": {
      "kty": "OKP",
      "crv": "Ed25519",
      "x": "JrQLj5P_89iXES9-vFgrIy29clF9CC_oPPsw3c5D0bs"
    }
  },
  "email": "user@example.com",
  "email_verified": true
}

</pre><a href="#section-5.1.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="format">
<section id="section-5.1.3">
          <h4 id="name-format">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-format" class="section-name selfRef">Format</a>
          </h4>
<p id="section-5.1.3-1">The EVT has a <code>~</code> appended to it for SD-JWT compatibility (see <a href="#sd-jwt-compatibility">SD-JWT Compatibility</a>).<a href="#section-5.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="evt-creation">
<section id="section-5.2">
        <h3 id="name-evt-creation">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-evt-creation" class="section-name selfRef">EVT Creation</a>
        </h3>
<p id="section-5.2-1">After verifying the request (see <a href="#request-verification">Request Verification</a>) and authenticating the user, the issuer creates the EVT:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-5.2-2">
<li id="section-5.2-2.1">Construct the header with <code>alg</code>, <code>kid</code>, and <code>typ</code><a href="#section-5.2-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.2-2.2">Construct the payload with <code>iss</code>, <code>iat</code>, <code>cnf</code> (containing the public key from the <code>Signature-Key</code> header), <code>email</code>, and <code>email_verified</code><a href="#section-5.2-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-5.2-2.3">If a private email is requested, include <code>is_private_email: true</code> and set <code>email</code> to the private address<a href="#section-5.2-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-5.2-2.4">Sign the JWT with the issuer's private key corresponding to the <code>kid</code><a href="#section-5.2-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-5.2-2.5">Append <code>~</code> to the signed JWT<a href="#section-5.2-2.5" class="pilcrow">¶</a>
</li>
        </ol>
<blockquote id="section-5.2-3">
          <p id="section-5.2-3.1">Note: The <code>is_private_email</code> claim name matches Apple's Sign in with Apple for compatibility with existing RP implementations.<a href="#section-5.2-3.1" class="pilcrow">¶</a></p>
</blockquote>
</section>
</div>
<div id="evt-verification">
<section id="section-5.3">
        <h3 id="name-evt-verification">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-evt-verification" class="section-name selfRef">EVT Verification</a>
        </h3>
<p id="section-5.3-1">Both the browser and RP verify the EVT. The verification steps are:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-5.3-2">
<li id="section-5.3-2.1">Parse the EVT into header, payload, and signature components<a href="#section-5.3-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-2.2">Extract and validate the <code>alg</code> and <code>kid</code> from the header<a href="#section-5.3-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-2.3">Extract and validate the <code>iss</code>, <code>iat</code>, <code>cnf</code>, <code>email</code>, and <code>email_verified</code> claims from the payload<a href="#section-5.3-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-2.4">Perform <a href="#issuer-discovery">Issuer Discovery</a> for the email domain to verify the <code>iss</code> claim matches the issuer identifier<a href="#section-5.3-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-2.5">Fetch the issuer's public keys from the <code>jwks_uri</code> in the issuer metadata<a href="#section-5.3-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-2.6">Verify the EVT signature using the public key identified by <code>kid</code><a href="#section-5.3-2.6" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-2.7">Verify <code>iat</code> is within an acceptable time window<a href="#section-5.3-2.7" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-2.8">Verify <code>email_verified</code> is <code>true</code><a href="#section-5.3-2.8" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-5.3-3">The browser additionally verifies:<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.3-4.1">The <code>email</code> claim matches the email address being verified<a href="#section-5.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-5.3-4.2">The <code>cnf.jwk</code> claim matches the public key the browser generated<a href="#section-5.3-4.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="kb">
<section id="section-6">
      <h2 id="name-key-binding-evtkb">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-key-binding-evtkb" class="section-name selfRef">Key Binding (EVT+KB)</a>
      </h2>
<p id="section-6-1">Key Binding ties an EVT to a specific RP and session through a Key Binding JWT (KB-JWT). The combined EVT+KB is what the RP receives and verifies.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="kb-structure">
<section id="section-6.1">
        <h3 id="name-kb-jwt-structure">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-kb-jwt-structure" class="section-name selfRef">KB-JWT Structure</a>
        </h3>
<p id="section-6.1-1">The KB-JWT is a JWT with the following structure:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div id="header-1">
<section id="section-6.1.1">
          <h4 id="name-header-2">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-header-2" class="section-name selfRef">Header</a>
          </h4>
<ul class="compact">
<li class="compact" id="section-6.1.1-1.1">
              <code>alg</code> (REQUIRED): Signing algorithm (same as the browser's key pair)<a href="#section-6.1.1-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-6.1.1-1.2">
              <code>typ</code> (REQUIRED): Set to "kb+jwt" for SD-JWT library compatibility<a href="#section-6.1.1-1.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.1.1-2">Example:<a href="#section-6.1.1-2" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-6.1.1-3">
<pre>{
  "alg": "EdDSA",
  "typ": "kb+jwt"
}

</pre><a href="#section-6.1.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="payload-1">
<section id="section-6.1.2">
          <h4 id="name-payload-2">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-payload-2" class="section-name selfRef">Payload</a>
          </h4>
<ul class="compact">
<li class="compact" id="section-6.1.2-1.1">
              <code>aud</code> (REQUIRED): The RP's origin<a href="#section-6.1.2-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-6.1.2-1.2">
              <code>nonce</code> (REQUIRED): The nonce from the RP's session<a href="#section-6.1.2-1.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-6.1.2-1.3">
              <code>iat</code> (REQUIRED): Issued at time<a href="#section-6.1.2-1.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-6.1.2-1.4">
              <code>sd_hash</code> (REQUIRED): SHA-256 hash of the EVT for SD-JWT library compatibility<a href="#section-6.1.2-1.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.1.2-2">Example:<a href="#section-6.1.2-2" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-6.1.2-3">
<pre>{
  "aud": "https://rp.example",
  "nonce": "259c5eae-486d-4b0f-b666-2a5b5ce1c925",
  "iat": 1724083260,
  "sd_hash": "X9yH0Ajrdm1Oij4tWso9UzzKJvPoDxwmuEcO3XAdRC0"
}

</pre><a href="#section-6.1.2-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="evt-kb-format">
<section id="section-6.2">
        <h3 id="name-evtkb-format">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-evtkb-format" class="section-name selfRef">EVT+KB Format</a>
        </h3>
<p id="section-6.2-1">The EVT+KB is formed by concatenating the EVT and KB-JWT separated by a tilde:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-2">
<pre>&lt;EVT&gt;~&lt;KB-JWT&gt;

</pre><a href="#section-6.2-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2-3">The EVT already has a trailing <code>~</code> from its SD-JWT format, so the full structure is:<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-4">
<pre>&lt;JWT&gt;~&lt;KB-JWT&gt;

</pre><a href="#section-6.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sd-jwt-compatibility">
<section id="section-6.3">
        <h3 id="name-sd-jwt-compatibility">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-sd-jwt-compatibility" class="section-name selfRef">SD-JWT Compatibility</a>
        </h3>
<p id="section-6.3-1">The EVT+KB format is compatible with SD-JWT with Key Binding as specified in <span>[<a href="#I-D.ietf-oauth-selective-disclosure-jwt" class="cite xref">I-D.ietf-oauth-selective-disclosure-jwt</a>]</span>, though this protocol does not use selective disclosure features. The following SD-JWT features are used:<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.3-2.1">
            <strong>Trailing <code>~</code> on EVT</strong>: The EVT uses the SD-JWT format (JWT with <code>~</code> suffix)<a href="#section-6.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.3-2.2">
            <strong><code>cnf</code> claim</strong>: The EVT includes the <code>cnf</code> claim with <code>jwk</code> for holder key binding<a href="#section-6.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.3-2.3">
            <strong><code>typ: "kb+jwt"</code></strong>: The KB-JWT uses the SD-JWT Key Binding JWT type<a href="#section-6.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.3-2.4">
            <strong><code>sd_hash</code> claim</strong>: The KB-JWT includes the SD-JWT hash of the EVT<a href="#section-6.3-2.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.3-2.5">
            <strong>Concatenation format</strong>: The EVT+KB uses the SD-JWT <code>&lt;Issuer-signed-JWT&gt;~&lt;KB-JWT&gt;</code> format<a href="#section-6.3-2.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.3-3">Standard SD-JWT libraries can be used to parse and validate EVT+KB tokens.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="kb-creation-detail">
<section id="section-6.4">
        <h3 id="name-kb-jwt-creation">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-kb-jwt-creation" class="section-name selfRef">KB-JWT Creation</a>
        </h3>
<p id="section-6.4-1">After verifying the EVT (see <a href="#evt-verification">EVT Verification</a>), the browser creates the KB-JWT:<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-6.4-2">
<li id="section-6.4-2.1">Construct the header with <code>alg</code> and <code>typ</code><a href="#section-6.4-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.4-2.2">
            <p id="section-6.4-2.2.1">Construct the payload with:<a href="#section-6.4-2.2.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.4-2.2.2.1">
                <code>aud</code>: The RP's origin<a href="#section-6.4-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-6.4-2.2.2.2">
                <code>nonce</code>: The nonce from the RP's session<a href="#section-6.4-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-6.4-2.2.2.3">
                <code>iat</code>: Current time<a href="#section-6.4-2.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-6.4-2.2.2.4">
                <code>sd_hash</code>: SHA-256 hash of the EVT (including the trailing <code>~</code>)<a href="#section-6.4-2.2.2.4" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-6.4-2.3">Sign the KB-JWT with the browser's private key<a href="#section-6.4-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-6.4-2.4">Concatenate with the EVT to form the EVT+KB<a href="#section-6.4-2.4" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="kb-verification">
<section id="section-6.5">
        <h3 id="name-kb-jwt-verification">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-kb-jwt-verification" class="section-name selfRef">KB-JWT Verification</a>
        </h3>
<p id="section-6.5-1">The RP verifies the KB-JWT by:<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-6.5-2">
<li id="section-6.5-2.1">Parse the EVT+KB by separating at the tilde<a href="#section-6.5-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.5-2.2">Parse the KB-JWT into header, payload, and signature<a href="#section-6.5-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.5-2.3">Extract <code>alg</code> from the header and <code>aud</code>, <code>nonce</code>, <code>iat</code>, <code>sd_hash</code> from the payload<a href="#section-6.5-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-6.5-2.4">Verify <code>aud</code> matches the RP's origin<a href="#section-6.5-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-6.5-2.5">Verify <code>nonce</code> matches the nonce from the RP's session<a href="#section-6.5-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-6.5-2.6">Verify <code>iat</code> is within a reasonable time window<a href="#section-6.5-2.6" class="pilcrow">¶</a>
</li>
          <li id="section-6.5-2.7">Compute the SHA-256 hash of the EVT and verify it matches <code>sd_hash</code><a href="#section-6.5-2.7" class="pilcrow">¶</a>
</li>
          <li id="section-6.5-2.8">Verify the KB-JWT signature using the public key from the EVT's <code>cnf.jwk</code> claim<a href="#section-6.5-2.8" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="webauthn-authentication">
<section id="section-7">
      <h2 id="name-webauthn-authentication">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-webauthn-authentication" class="section-name selfRef">WebAuthn Authentication</a>
      </h2>
<p id="section-7-1">When the issuer supports WebAuthn (<code>webauthn_supported: true</code> in metadata) and a token request lacks valid authentication cookies, the issuer MAY return a WebAuthn challenge to authenticate the user. This enables email verification even when the user is not logged into the issuer via cookies, using any WebAuthn-compatible credential (passkeys, security keys, platform authenticators).<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="webauthn-challenge-response">
<section id="section-7.1">
        <h3 id="name-webauthn-challenge-response">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-webauthn-challenge-response" class="section-name selfRef">WebAuthn Challenge Response</a>
        </h3>
<p id="section-7.1-1">Instead of returning an error or an EVT, the issuer returns a WebAuthn challenge. The issuer MAY include <code>Set-Cookie</code> headers to maintain challenge state:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2"><strong>HTTP 401 Unauthorized</strong><a href="#section-7.1-2" class="pilcrow">¶</a></p>
<div class="lang-http sourcecode" id="section-7.1-3">
<pre>HTTP/1.1 401 Unauthorized
Content-Type: application/json
Set-Cookie: webauthn_state=...; Secure; HttpOnly; SameSite=None; Max-Age=300

{
  "webauthn_challenge": {
    "challenge": "dGVzdC1jaGFsbGVuZ2UtZGF0YQ",
    "timeout": 60000,
    "rpId": "issuer.example",
    "allowCredentials": [
      {
        "type": "public-key",
        "id": "Y3JlZGVudGlhbC1pZA"
      }
    ],
    "userVerification": "preferred"
  }
}

</pre><a href="#section-7.1-3" class="pilcrow">¶</a>
</div>
<p id="section-7.1-4">The <code>webauthn_challenge</code> object follows the structure of PublicKeyCredentialRequestOptions as defined in <span>[<a href="#WebAuthn" class="cite xref">WebAuthn</a>]</span>.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<p id="section-7.1-5">The browser MUST process any <code>Set-Cookie</code> headers in the response. The issuer can use cookies to maintain challenge state, enabling stateless verification of the WebAuthn response. Alternatively, the issuer MAY store challenges server-side with a short TTL.<a href="#section-7.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="webauthn-response">
<section id="section-7.2">
        <h3 id="name-webauthn-response">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-webauthn-response" class="section-name selfRef">WebAuthn Response</a>
        </h3>
<p id="section-7.2-1">After the browser obtains a WebAuthn assertion (this mechanism is being defined by the W3C (<span>[<a href="#EVP-Browser" class="cite xref">EVP-Browser</a>]</span>)), it sends a new request to the issuance endpoint with the <code>webauthn_response</code>. The browser MUST include any cookies set by the challenge response:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<div class="lang-http sourcecode" id="section-7.2-2">
<pre>POST /email-verification/issuance HTTP/1.1
Host: accounts.issuer.example
Cookie: webauthn_state=...
Content-Type: application/json
Content-Digest: sha-256=:...:
Sec-Fetch-Dest: email-verification
Signature-Input: sig=("@method" "@authority" "@path" "content-digest" "cookie" "signature-key");created=1692345600
Signature: sig=:...:
Signature-Key: sig=hwk; kty="OKP"; crv="Ed25519"; x="JrQLj5P_89iXES9-vFgrIy29clF9CC_oPPsw3c5D0bs"

{
  "email": "user@example.com",
  "webauthn_response": {
    "id": "Y3JlZGVudGlhbC1pZA",
    "rawId": "Y3JlZGVudGlhbC1pZA",
    "response": {
      "authenticatorData": "...",
      "clientDataJSON": "...",
      "signature": "..."
    },
    "type": "public-key"
  }
}

</pre><a href="#section-7.2-2" class="pilcrow">¶</a>
</div>
<p id="section-7.2-3">The <code>webauthn_response</code> object follows the structure of PublicKeyCredential as defined in <span>[<a href="#WebAuthn" class="cite xref">WebAuthn</a>]</span>.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<blockquote id="section-7.2-4">
          <p id="section-7.2-4.1">Note: The <code>cookie</code> component MUST be included in the signature when cookies are present (such as those set by the challenge response). If no cookies are present, the <code>cookie</code> component is omitted per <a href="#request-signing">HTTP Request Signing</a>.<a href="#section-7.2-4.1" class="pilcrow">¶</a></p>
</blockquote>
</section>
</div>
<div id="webauthn-verification">
<section id="section-7.3">
        <h3 id="name-webauthn-verification">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-webauthn-verification" class="section-name selfRef">WebAuthn Verification</a>
        </h3>
<p id="section-7.3-1">The issuer verifies the WebAuthn response against its stored credentials for the email address. If verification succeeds, the issuer returns the EVT as described in <a href="#evt-issuance">EVT Issuance</a>.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="private-email">
<section id="section-8">
      <h2 id="name-private-email-addresses">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-private-email-addresses" class="section-name selfRef">Private Email Addresses</a>
      </h2>
<p id="section-8-1">Private email addresses allow users to provide site-specific email addresses to RPs, preventing RP-to-RP correlation of users by email address. A private email address can be:<a href="#section-8-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8-2.1">
          <strong>Single-use</strong>: The browser requests a new private email and does not store it<a href="#section-8-2.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-8-2.2">
          <strong>Reusable</strong>: The browser stores the private email and passes it back via <code>directed_email</code> for account continuity<a href="#section-8-2.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-8-3">The choice between single-use and reusable is made by the browser or user, not the issuer. The first request to an RP always uses <code>private_email: true</code> to obtain a new private email address. For subsequent requests, the browser can either request another new private email or reuse an existing one by passing it in <code>directed_email</code>.<a href="#section-8-3" class="pilcrow">¶</a></p>
<div id="request-parameters">
<section id="section-8.1">
        <h3 id="name-request-parameters">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-request-parameters" class="section-name selfRef">Request Parameters</a>
        </h3>
<p id="section-8.1-1">The token request body supports one of the following parameters for private email addresses (mutually exclusive):<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-2.1">
            <p id="section-8.1-2.1.1"><code>private_email</code> (OPTIONAL): Boolean. When set to <code>true</code>, requests a new private email address instead of the user's actual email.<a href="#section-8.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-2.2">
            <p id="section-8.1-2.2.1"><code>directed_email</code> (OPTIONAL): String. A previously issued private email address. When provided, the issuer returns the same private email address if it is valid and linked to the <code>email</code> in the request.<a href="#section-8.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="example-requests">
<section id="section-8.2">
        <h3 id="name-example-requests">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-example-requests" class="section-name selfRef">Example Requests</a>
        </h3>
<p id="section-8.2-1">Request for a new private email address:<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-8.2-2">
<pre>{
  "email": "user@example.com",
  "private_email": true
}

</pre><a href="#section-8.2-2" class="pilcrow">¶</a>
</div>
<p id="section-8.2-3">Request to reuse a previously issued private email address:<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-8.2-4">
<pre>{
  "email": "user@example.com",
  "directed_email": "u7x9k2m4@privaterelay.example"
}

</pre><a href="#section-8.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="requirements">
<section id="section-8.3">
        <h3 id="name-requirements">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-requirements" class="section-name selfRef">Requirements</a>
        </h3>
<ul class="compact">
<li class="compact" id="section-8.3-1.1">The private email MUST be a valid email address that the issuer can route to the user's actual mailbox<a href="#section-8.3-1.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.3-1.2">The private email SHOULD be unique per user and per RP origin (derived from the browser's context)<a href="#section-8.3-1.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.3-1.3">If <code>directed_email</code> is provided and is linked to the <code>email</code> address in the request, the issuer MUST return the same private email address<a href="#section-8.3-1.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.3-1.4">If <code>directed_email</code> is provided but is invalid or not linked to the <code>email</code>, the issuer MUST return an error<a href="#section-8.3-1.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.3-1.5">The private email address is included in the EVT <code>email</code> claim<a href="#section-8.3-1.5" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.3-1.6">The EVT MUST include <code>is_private_email: true</code> when a private email address is issued<a href="#section-8.3-1.6" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="issuer-flexibility">
<section id="section-8.4">
        <h3 id="name-issuer-flexibility">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-issuer-flexibility" class="section-name selfRef">Issuer Flexibility</a>
        </h3>
<p id="section-8.4-1">The domain of the private email address does not need to match the domain of the user's actual email address. Additionally, the <code>iss</code> claim in the EVT corresponds to the issuer for the private email domain, which may differ from the issuer the browser initially contacted.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4-2">For example, a user with <code>user@example.com</code> may receive a private email address <code>u7x9k2m4@privaterelay.different.example</code>. The EVT's <code>iss</code> claim would be the issuer for <code>privaterelay.different.example</code>. The browser verifies the EVT by performing issuer discovery on the private email domain and validating the signature against that issuer's JWKS. This allows email providers to delegate private email functionality to a separate service.<a href="#section-8.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-evt-payload">
<section id="section-8.5">
        <h3 id="name-example-evt-payload">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-example-evt-payload" class="section-name selfRef">Example EVT Payload</a>
        </h3>
<p id="section-8.5-1">When a private email is issued, the EVT contains the private address in the <code>email</code> claim and includes <code>is_private_email: true</code>:<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-8.5-2">
<pre>{
  "iss": "privaterelay.different.example",
  "iat": 1724083200,
  "cnf": {
    "jwk": {
      "kty": "OKP",
      "crv": "Ed25519",
      "x": "JrQLj5P_89iXES9-vFgrIy29clF9CC_oPPsw3c5D0bs"
    }
  },
  "email": "u7x9k2m4@privaterelay.different.example",
  "email_verified": true,
  "is_private_email": true
}

</pre><a href="#section-8.5-2" class="pilcrow">¶</a>
</div>
<p id="section-8.5-3">The browser MAY store the private email address so it can provide it as <code>directed_email</code> in future requests if the user wants to reuse the same private email address at an RP.<a href="#section-8.5-3" class="pilcrow">¶</a></p>
<p id="section-8.5-4">See <a href="#privacy-considerations">Privacy Considerations</a> for privacy analysis of private email addresses.<a href="#section-8.5-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="error-responses">
<section id="section-9">
      <h2 id="name-error-responses">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-error-responses" class="section-name selfRef">Error Responses</a>
      </h2>
<p id="section-9-1">If the issuer cannot process the token request successfully, it MUST return an appropriate HTTP status code with a JSON error response containing an <code>error</code> field and optionally an <code>error_description</code> field.<a href="#section-9-1" class="pilcrow">¶</a></p>
<div id="invalid-content-type-header">
<section id="section-9.1">
        <h3 id="name-invalid-content-type-header">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-invalid-content-type-header" class="section-name selfRef">Invalid Content-Type Header</a>
        </h3>
<p id="section-9.1-1">When the request does not include the required <code>Content-Type: application/json</code> header, the server MUST return the 415 HTTP response code.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="invalid-sec-fetch-dest-header">
<section id="section-9.2">
        <h3 id="name-invalid-sec-fetch-dest-head">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-invalid-sec-fetch-dest-head" class="section-name selfRef">Invalid Sec-Fetch-Dest Header</a>
        </h3>
<p id="section-9.2-1">When the request does not include the required <code>Sec-Fetch-Dest: email-verification</code> header:<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2"><strong>HTTP 400 Bad Request</strong><a href="#section-9.2-2" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-9.2-3">
<pre>{
  "error": "invalid_request",
  "error_description": "Missing or invalid Sec-Fetch-Dest header"
}

</pre><a href="#section-9.2-3" class="pilcrow">¶</a>
</div>
<p id="section-9.2-4">The <code>error_description</code> SHOULD specify that the Sec-Fetch-Dest header is missing or invalid.<a href="#section-9.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="invalid-or-missing-http-message-signature">
<section id="section-9.3">
        <h3 id="name-invalid-or-missing-http-mes">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-invalid-or-missing-http-mes" class="section-name selfRef">Invalid or Missing HTTP Message Signature</a>
        </h3>
<p id="section-9.3-1">When the HTTP Message Signature is missing, malformed, or verification fails:<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2"><strong>HTTP 400 Bad Request</strong><a href="#section-9.3-2" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-9.3-3">
<pre>{
  "error": "invalid_signature",
  "error_description": "HTTP Message Signature verification failed"
}

</pre><a href="#section-9.3-3" class="pilcrow">¶</a>
</div>
<p id="section-9.3-4">This includes cases where:
- The <code>Signature</code>, <code>Signature-Input</code>, or <code>Signature-Key</code> headers are missing
- The <code>Signature-Key</code> header does not use the <code>hwk</code> scheme or is malformed
- The signature does not cover the required components
- The signature verification fails using the public key from <code>Signature-Key</code>
- The <code>created</code> timestamp is outside the acceptable time window<a href="#section-9.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="invalid-content-digest">
<section id="section-9.4">
        <h3 id="name-invalid-content-digest">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-invalid-content-digest" class="section-name selfRef">Invalid Content-Digest</a>
        </h3>
<p id="section-9.4-1">When the <code>Content-Digest</code> header is missing or does not match the request body:<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<p id="section-9.4-2"><strong>HTTP 400 Bad Request</strong><a href="#section-9.4-2" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-9.4-3">
<pre>{
  "error": "invalid_request",
  "error_description": "Content-Digest header missing or does not match request body"
}

</pre><a href="#section-9.4-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authentication-required">
<section id="section-9.5">
        <h3 id="name-authentication-required">
<a href="#section-9.5" class="section-number selfRef">9.5. </a><a href="#name-authentication-required" class="section-name selfRef">Authentication Required</a>
        </h3>
<p id="section-9.5-1">When the request lacks valid authentication cookies, contains expired/invalid cookies, or the authenticated user does not have control of the requested email address:<a href="#section-9.5-1" class="pilcrow">¶</a></p>
<p id="section-9.5-2"><strong>HTTP 401 Unauthorized</strong><a href="#section-9.5-2" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-9.5-3">
<pre>{
  "error": "authentication_required",
  "error_description": "User must be authenticated and have control of the requested email address"
}

</pre><a href="#section-9.5-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="invalid-parameters">
<section id="section-9.6">
        <h3 id="name-invalid-parameters">
<a href="#section-9.6" class="section-number selfRef">9.6. </a><a href="#name-invalid-parameters" class="section-name selfRef">Invalid Parameters</a>
        </h3>
<p id="section-9.6-1">When the request body is malformed, missing the <code>email</code> field, or contains invalid values:<a href="#section-9.6-1" class="pilcrow">¶</a></p>
<p id="section-9.6-2"><strong>HTTP 400 Bad Request</strong><a href="#section-9.6-2" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-9.6-3">
<pre>{
  "error": "invalid_request",
  "error_description": "Invalid or malformed request body"
}

</pre><a href="#section-9.6-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="private-email-not-supported">
<section id="section-9.7">
        <h3 id="name-private-email-not-supported">
<a href="#section-9.7" class="section-number selfRef">9.7. </a><a href="#name-private-email-not-supported" class="section-name selfRef">Private Email Not Supported</a>
        </h3>
<p id="section-9.7-1">When the request includes <code>private_email</code> or <code>directed_email</code> but the issuer does not support private email addresses (<code>private_email_supported</code> is <code>false</code> or absent in metadata):<a href="#section-9.7-1" class="pilcrow">¶</a></p>
<p id="section-9.7-2"><strong>HTTP 400 Bad Request</strong><a href="#section-9.7-2" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-9.7-3">
<pre>{
  "error": "private_email_not_supported",
  "error_description": "This issuer does not support private email addresses"
}

</pre><a href="#section-9.7-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="invalid-directed-email">
<section id="section-9.8">
        <h3 id="name-invalid-directed-email">
<a href="#section-9.8" class="section-number selfRef">9.8. </a><a href="#name-invalid-directed-email" class="section-name selfRef">Invalid Directed Email</a>
        </h3>
<p id="section-9.8-1">When the request includes <code>directed_email</code> but the private email address is invalid or not linked to the <code>email</code> address in the request:<a href="#section-9.8-1" class="pilcrow">¶</a></p>
<p id="section-9.8-2"><strong>HTTP 400 Bad Request</strong><a href="#section-9.8-2" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-9.8-3">
<pre>{
  "error": "invalid_directed_email",
  "error_description": "The directed_email is invalid or not linked to this email address"
}

</pre><a href="#section-9.8-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="server-errors">
<section id="section-9.9">
        <h3 id="name-server-errors">
<a href="#section-9.9" class="section-number selfRef">9.9. </a><a href="#name-server-errors" class="section-name selfRef">Server Errors</a>
        </h3>
<p id="section-9.9-1">For internal server errors or temporary unavailability:<a href="#section-9.9-1" class="pilcrow">¶</a></p>
<p id="section-9.9-2"><strong>HTTP 500 Internal Server Error</strong><a href="#section-9.9-2" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-9.9-3">
<pre>{
  "error": "server_error",
  "error_description": "Temporary server error, please try again later"
}

</pre><a href="#section-9.9-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-10">
      <h2 id="name-privacy-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-10-1">This section analyzes the privacy properties of the Email Verification Protocol, following the guidance in <span>[<a href="#RFC6973" class="cite xref">RFC6973</a>]</span>.<a href="#section-10-1" class="pilcrow">¶</a></p>
<div id="reduced-friction-tradeoff">
<section id="section-10.1">
        <h3 id="name-reduced-friction-tradeoff">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-reduced-friction-tradeoff" class="section-name selfRef">Reduced Friction Tradeoff</a>
        </h3>
<p id="section-10.1-1">By reducing friction in email verification, EVP makes it easier for users to provide their email address to more sites. This convenience could accelerate the RP correlation problem—users may share a correlatable identifier with more RPs than they would if verification required more effort.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">EVP addresses this tradeoff through private email addresses. When supported by the issuer, users can present a site-specific private email that cannot be correlated across RPs. This makes sharing a non-correlatable identifier just as easy as sharing the user's real email address, giving users a privacy-preserving option without additional friction.<a href="#section-10.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="timing-correlation-by-email-providers">
<section id="section-10.2">
        <h3 id="name-timing-correlation-by-email">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-timing-correlation-by-email" class="section-name selfRef">Timing Correlation by Email Providers</a>
        </h3>
<p id="section-10.2-1">The three-party model (see <a href="#protocol-flow">Protocol Flow</a>) prevents the issuer from learning which RP requested verification. When the RP uses the email only for identification and does not send emails, the email provider never learns about the RP at all. When the RP does send emails, the provider eventually learns about that RP, but only when email is actually sent—not at verification time. This dulls timing correlation.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rp-correlation-via-email-addresses">
<section id="section-10.3">
        <h3 id="name-rp-correlation-via-email-ad">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-rp-correlation-via-email-ad" class="section-name selfRef">RP Correlation via Email Addresses</a>
        </h3>
<p id="section-10.3-1">Private email addresses prevent RPs from correlating users across sites. Additional benefits:<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<p id="section-10.3-2"><strong>Protection from data breaches</strong>: If an RP suffers a data breach, only the private email is exposed—not the user's primary email address.<a href="#section-10.3-2" class="pilcrow">¶</a></p>
<p id="section-10.3-3"><strong>Protection from unwanted email</strong>: Because the issuer controls private email routing, users can revoke or filter mail to specific addresses without affecting their primary inbox.<a href="#section-10.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuer-knowledge">
<section id="section-10.4">
        <h3 id="name-issuer-knowledge">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-issuer-knowledge" class="section-name selfRef">Issuer Knowledge</a>
        </h3>
<p id="section-10.4-1">The issuer learns certain information through the protocol:<a href="#section-10.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.4-2">
<li id="section-10.4-2.1">
            <p id="section-10.4-2.1.1"><strong>Email addresses</strong>: The issuer learns that the user controls the email address in the request. This may reveal email addresses at domains the issuer is authoritative for that it did not previously know the user had.<a href="#section-10.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-10.4-2.2">
            <p id="section-10.4-2.2.1"><strong>Verification requests</strong>: The issuer sees that verification was requested but does not learn which RP requested it (maintained by the three-party model).<a href="#section-10.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-10.4-2.3">
            <p id="section-10.4-2.3.1"><strong>Private email mappings</strong>: When generating private emails, the issuer stores mappings between private addresses and user email addresses for mail routing.<a href="#section-10.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-10.4-2.4">
            <p id="section-10.4-2.4.1"><strong>Email traffic</strong>: When RPs send email to private addresses, the issuer (operating the relay) learns about those communications.<a href="#section-10.4-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="rp-knowledge">
<section id="section-10.5">
        <h3 id="name-rp-knowledge">
<a href="#section-10.5" class="section-number selfRef">10.5. </a><a href="#name-rp-knowledge" class="section-name selfRef">RP Knowledge</a>
        </h3>
<p id="section-10.5-1">The RP can infer whether the user is logged into the issuer: the RP receives an EVT when the user is logged in, and receives an error when the user is not. This is inherent to any authentication-based verification scheme.<a href="#section-10.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="browser-storage">
<section id="section-10.6">
        <h3 id="name-browser-storage">
<a href="#section-10.6" class="section-number selfRef">10.6. </a><a href="#name-browser-storage" class="section-name selfRef">Browser Storage</a>
        </h3>
<p id="section-10.6-1">The browser MAY store the private email address per RP origin to enable account continuity by passing it as <code>directed_email</code> in future requests.<a href="#section-10.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-11">
      <h2 id="name-security-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="http-message-signature-security">
<section id="section-11.1">
        <h3 id="name-http-message-signature-secu">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-http-message-signature-secu" class="section-name selfRef">HTTP Message Signature Security</a>
        </h3>
<p id="section-11.1-1">The use of HTTP Message Signatures (<span>[<a href="#RFC9421" class="cite xref">RFC9421</a>]</span>) provides several security benefits:<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-11.1-2">
<li id="section-11.1-2.1">
            <p id="section-11.1-2.1.1"><strong>Request Integrity</strong>: The signature covers the HTTP method, target URI, authority, content-digest, cookies, and security headers, preventing tampering with any of these components.<a href="#section-11.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.1-2.2">
            <p id="section-11.1-2.2.1"><strong>Cookie Binding</strong>: By including the <code>cookie</code> component in the signature, the browser's authentication cookies are cryptographically bound to the specific request, preventing cookie injection or manipulation attacks.<a href="#section-11.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.1-2.3">
            <p id="section-11.1-2.3.1"><strong>Replay Protection</strong>: The <code>created</code> timestamp in the <code>Signature-Input</code> header is verified to be within 60 seconds, preventing replay attacks.<a href="#section-11.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.1-2.4">
            <p id="section-11.1-2.4.1"><strong>Public Key Binding</strong>: The browser's public key transmitted via the <code>Signature-Key</code> header with the <code>hwk</code> scheme is bound to the request signature, ensuring the issuer knows which public key to include in the EVT's <code>cnf</code> claim.<a href="#section-11.1-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="signature-key-hwk-scheme">
<section id="section-11.2">
        <h3 id="name-signature-key-hwk-scheme">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-signature-key-hwk-scheme" class="section-name selfRef">Signature-Key hwk Scheme</a>
        </h3>
<p id="section-11.2-1">The <code>hwk</code> (Header Web Key) scheme provides:<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-11.2-2">
<li id="section-11.2-2.1">
            <p id="section-11.2-2.1.1"><strong>Self-Contained Key Distribution</strong>: The public key is transmitted inline, eliminating the need for a separate key lookup or registration process.<a href="#section-11.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.2-2.2">
            <p id="section-11.2-2.2.1"><strong>Pseudonymity</strong>: The browser does not need to identify itself - the key serves as a pseudonymous identifier for the request.<a href="#section-11.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.2-2.3">
            <p id="section-11.2-2.3.1"><strong>Ephemeral Keys</strong>: The browser generates fresh key pairs for each verification flow, limiting the correlation potential across different verification attempts.<a href="#section-11.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="email-existence-probing">
<section id="section-11.3">
        <h3 id="name-email-existence-probing">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-email-existence-probing" class="section-name selfRef">Email Existence Probing</a>
        </h3>
<p id="section-11.3-1">Any software—not just browsers—can send requests to an issuer's issuance endpoint. An attacker could attempt to use this to probe for valid email addresses:<a href="#section-11.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-11.3-2">
<li id="section-11.3-2.1">
            <strong>Build email lists</strong>: Probe many addresses to identify valid ones for spam targeting.<a href="#section-11.3-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-11.3-2.2">
            <strong>Account enumeration</strong>: Determine which email addresses have accounts at specific issuers.<a href="#section-11.3-2.2" class="pilcrow">¶</a>
</li>
        </ol>
<div id="uniform-error-responses">
<section id="section-11.3.1">
          <h4 id="name-uniform-error-responses">
<a href="#section-11.3.1" class="section-number selfRef">11.3.1. </a><a href="#name-uniform-error-responses" class="section-name selfRef">Uniform Error Responses</a>
          </h4>
<p id="section-11.3.1-1">To prevent probing, issuers MUST NOT return different error responses based on whether an email address exists. The <code>authentication_required</code> error should be returned uniformly whether:<a href="#section-11.3.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-11.3.1-2.1">The email address does not exist at this issuer<a href="#section-11.3.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-11.3.1-2.2">The email address exists but the user is not authenticated<a href="#section-11.3.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-11.3.1-2.3">The email address exists but the authenticated user does not control it<a href="#section-11.3.1-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-11.3.1-3">This ensures attackers cannot distinguish between "email exists" and "email does not exist" based on error responses.<a href="#section-11.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="timing-attack-mitigations">
<section id="section-11.3.2">
          <h4 id="name-timing-attack-mitigations">
<a href="#section-11.3.2" class="section-number selfRef">11.3.2. </a><a href="#name-timing-attack-mitigations" class="section-name selfRef">Timing Attack Mitigations</a>
          </h4>
<p id="section-11.3.2-1">Response timing can also reveal whether an email address exists. If the issuer performs a database lookup only when the email exists, or takes different code paths based on email existence, an attacker can measure response times to infer information.<a href="#section-11.3.2-1" class="pilcrow">¶</a></p>
<p id="section-11.3.2-2">Issuers SHOULD mitigate timing attacks using techniques such as:<a href="#section-11.3.2-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-11.3.2-3.1">
              <strong>Uniform code paths</strong>: Execute the same operations (database lookups, cryptographic operations) regardless of whether the email exists, avoiding early returns that skip processing steps.<a href="#section-11.3.2-3.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-11.3.2-3.2">
              <strong>Response delay normalization</strong>: Add delays to normalize response times across all error conditions to a consistent baseline.<a href="#section-11.3.2-3.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="additional-mitigations">
<section id="section-11.3.3">
          <h4 id="name-additional-mitigations">
<a href="#section-11.3.3" class="section-number selfRef">11.3.3. </a><a href="#name-additional-mitigations" class="section-name selfRef">Additional Mitigations</a>
          </h4>
<ul class="compact">
<li class="compact" id="section-11.3.3-1.1">
              <strong>User interaction required</strong>: The browser API requires user gesture and consent before initiating verification, preventing automated probing from browsers.<a href="#section-11.3.3-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-11.3.3-1.2">
              <strong>Rate limiting</strong>: Issuers SHOULD rate-limit requests per IP address to slow down probing attempts from any client.<a href="#section-11.3.3-1.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-11.3.3-1.3">
              <strong>Sec-Fetch-Dest verification</strong>: The required <code>Sec-Fetch-Dest: email-verification</code> header provides a signal that the request originates from a browser, though this can be spoofed by non-browser clients.<a href="#section-11.3.3-1.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-11.3.3-1.4">
              <strong>Same information as email OTP</strong>: An attacker can already determine email existence by sending verification emails and checking for bounces. EVP does not create new information disclosure beyond what is already possible.<a href="#section-11.3.3-1.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-11.3.3-2">Issuers SHOULD implement appropriate rate limiting and abuse detection.<a href="#section-11.3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="design-rationale">
<section id="section-12">
      <h2 id="name-design-rationale">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-design-rationale" class="section-name selfRef">Design Rationale</a>
      </h2>
<div id="why-not-solve-email-like-sms-otp">
<section id="section-12.1">
        <h3 id="name-why-not-solve-email-like-sm">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-why-not-solve-email-like-sm" class="section-name selfRef">Why Not Solve Email Like SMS OTP?</a>
        </h3>
<p id="section-12.1-1">The WebOTP API and <code>autocomplete="one-time-code"</code> standards dramatically reduced friction for SMS verification. A natural question is why email verification cannot use the same approach. Several fundamental differences make this impractical:<a href="#section-12.1-1" class="pilcrow">¶</a></p>
<p id="section-12.1-2"><strong>SMS is a mobile OS feature; email is application-layer</strong><a href="#section-12.1-2" class="pilcrow">¶</a></p>
<p id="section-12.1-3">SMS is integrated into mobile operating systems. The OS receives incoming messages and can parse them before any application sees them. This privileged position enables the OS to recognize origin-bound OTP formats and offer autofill directly to the browser.<a href="#section-12.1-3" class="pilcrow">¶</a></p>
<p id="section-12.1-4">Email operates at the application layer. There is no OS-level email subsystem that intercepts incoming messages. Email clients are ordinary applications—whether native apps, desktop programs, or web applications—with no special ability to coordinate with browsers for autofill.<a href="#section-12.1-4" class="pilcrow">¶</a></p>
<p id="section-12.1-5"><strong>SMS verification is mobile; email verification spans platforms</strong><a href="#section-12.1-5" class="pilcrow">¶</a></p>
<p id="section-12.1-6">SMS OTP autofill works on mobile devices where the OS controls the messaging stack. Email verification happens on desktop computers, laptops, tablets, and phones. Any solution for email must work across all these platforms, not just mobile.<a href="#section-12.1-6" class="pilcrow">¶</a></p>
<p id="section-12.1-7"><strong>SMS senders are aggregators; email senders are RPs</strong><a href="#section-12.1-7" class="pilcrow">¶</a></p>
<p id="section-12.1-8">SMS verification messages are typically sent through aggregator services (Twilio, AWS SNS, etc.) that send on behalf of many relying parties. The "sender" of the SMS is often a short code or phone number shared across multiple services. This means the phone number or sender ID carries little identifying information about which RP sent the message.<a href="#section-12.1-8" class="pilcrow">¶</a></p>
<p id="section-12.1-9">Email verification messages come directly from the RP's domain. The sender address, domain, and email headers identify the RP. This architectural difference means that email verification inherently reveals more about the RP to the email provider than SMS verification reveals to the carrier.<a href="#section-12.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="why-the-three-party-model">
<section id="section-12.2">
        <h3 id="name-why-the-three-party-model">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-why-the-three-party-model" class="section-name selfRef">Why the Three-Party Model?</a>
        </h3>
<p id="section-12.2-1">A simpler design would have the issuer create a token directly for the RP, with the RP as the audience. This is how social login works: the identity provider knows which application the user is logging into.<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<p id="section-12.2-2">EVP uses a three-party model where the browser intermediates between the issuer and the RP. The issuer creates an EVT bound to the browser's ephemeral public key, and the browser creates a separate KB-JWT that binds the EVT to the RP. The issuer never learns the RP's identity.<a href="#section-12.2-2" class="pilcrow">¶</a></p>
<p id="section-12.2-3">This design choice is driven by privacy: for users with domain-based email accounts (personal domains, work accounts), the email provider should not learn which applications the user accesses. The architectural complexity of the three-party model is justified by this privacy benefit.<a href="#section-12.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="why-sd-jwt">
<section id="section-12.3">
        <h3 id="name-why-sd-jwt">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-why-sd-jwt" class="section-name selfRef">Why SD-JWT?</a>
        </h3>
<p id="section-12.3-1">The EVT uses the SD-JWT structure (specifically, the key binding capability from SD-JWT+KB) rather than a plain JWT. This choice provides:<a href="#section-12.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-12.3-2">
<li id="section-12.3-2.1">
            <p id="section-12.3-2.1.1"><strong>Key Binding</strong>: The <code>~</code> separator and KB-JWT mechanism provide a standard way to bind a token to a holder's key, enabling the three-party model where issuance and presentation are separate operations.<a href="#section-12.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.3-2.2">
            <p id="section-12.3-2.2.1"><strong>Library Support</strong>: SD-JWT libraries already exist and can parse EVTs, reducing implementation burden for RPs.<a href="#section-12.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.3-2.3">
            <p id="section-12.3-2.3.1"><strong>Extensibility</strong>: While EVP does not currently use selective disclosure, the SD-JWT structure allows future extensions without changing the token format.<a href="#section-12.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="why-dns-delegation">
<section id="section-12.4">
        <h3 id="name-why-dns-delegation">
<a href="#section-12.4" class="section-number selfRef">12.4. </a><a href="#name-why-dns-delegation" class="section-name selfRef">Why DNS Delegation?</a>
        </h3>
<p id="section-12.4-1">The mail domain delegates email verification to an issuer via a DNS TXT record rather than a <code>.well-known</code> file. This choice aligns with how email infrastructure already works:<a href="#section-12.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-12.4-2">
<li id="section-12.4-2.1">
            <p id="section-12.4-2.1.1"><strong>Email domains often lack web hosting</strong>: Many users have personal domains used only for email. Requiring a web server to host a <code>.well-known</code> file would create a barrier to adoption.<a href="#section-12.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.4-2.2">
            <p id="section-12.4-2.2.1"><strong>Apex domain challenges</strong>: Email domains are typically apex domains (e.g., <code>example.com</code>), which do not support CNAME records. Hosting a web site on an apex domain requires additional infrastructure.<a href="#section-12.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.4-2.3">
            <p id="section-12.4-2.3.1"><strong>Familiar tooling</strong>: Domain owners already manage DNS records for email (MX, SPF, DKIM, DMARC). Adding another TXT record fits existing workflows.<a href="#section-12.4-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="why-jwks-over-dkim-keys">
<section id="section-12.5">
        <h3 id="name-why-jwks-over-dkim-keys">
<a href="#section-12.5" class="section-number selfRef">12.5. </a><a href="#name-why-jwks-over-dkim-keys" class="section-name selfRef">Why JWKS Over DKIM Keys?</a>
        </h3>
<p id="section-12.5-1">The issuer publishes signing keys via a JWKS endpoint rather than reusing DKIM keys. While DKIM keys are already associated with email domains, JWKS provides practical advantages:<a href="#section-12.5-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-12.5-2">
<li id="section-12.5-2.1">
            <p id="section-12.5-2.1.1"><strong>Key rotation</strong>: DKIM keys are rarely rotated in practice. JWKS rotation is common in OIDC deployments and follows established patterns.<a href="#section-12.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.5-2.2">
            <p id="section-12.5-2.2.1"><strong>Algorithm flexibility</strong>: JWKS supports multiple key types and algorithms. DKIM key distribution was designed for a specific use case.<a href="#section-12.5-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.5-2.3">
            <p id="section-12.5-2.3.1"><strong>Operational familiarity</strong>: Developers implementing EVP are likely familiar with JWKS from OAuth/OIDC work.<a href="#section-12.5-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="why-http-message-signatures-rather-than-request-jwt">
<section id="section-12.6">
        <h3 id="name-why-http-message-signatures">
<a href="#section-12.6" class="section-number selfRef">12.6. </a><a href="#name-why-http-message-signatures" class="section-name selfRef">Why HTTP Message Signatures Rather Than Request JWT?</a>
        </h3>
<p id="section-12.6-1">The original design used a JWT signed by the browser to carry the email address and browser's public key. The HTTP Message Signatures approach was chosen because:<a href="#section-12.6-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-12.6-2">
<li id="section-12.6-2.1">
            <strong>Standards-Based</strong>: <span>[<a href="#RFC9421" class="cite xref">RFC9421</a>]</span> is a published standard for signing HTTP messages, providing better interoperability<a href="#section-12.6-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-12.6-2.2">
            <strong>Cookie Binding</strong>: HTTP Message Signatures can directly sign the <code>cookie</code> header, providing stronger binding between authentication cookies and the request<a href="#section-12.6-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-12.6-2.3">
            <strong>Content Integrity</strong>: The <code>content-digest</code> component provides built-in content integrity without needing to duplicate the email in a JWT<a href="#section-12.6-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-12.6-2.4">
            <strong>Flexibility</strong>: The signature can cover any HTTP components, making it easier to add additional protections in the future<a href="#section-12.6-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-12.6-2.5">
            <strong>Simpler Key Distribution</strong>: The Signature-Key header provides a standardized way to distribute keys inline with the request<a href="#section-12.6-2.5" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
</section>
</div>
<section id="section-13">
      <h2 id="name-references">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-13.1">
        <h3 id="name-normative-references">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.hardt-httpbis-signature-key">[I-D.hardt-httpbis-signature-key]</dt>
        <dd>
<span class="refAuthor">Hardt, D.</span> and <span class="refAuthor">T. Meunier</span>, <span class="refTitle">"HTTP Signature-Key Header"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hardt-httpbis-signature-key-01</span>, <time datetime="2026-01-08" class="refDate">8 January 2026</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-hardt-httpbis-signature-key-01">https://datatracker.ietf.org/doc/html/draft-hardt-httpbis-signature-key-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-oauth-selective-disclosure-jwt">[I-D.ietf-oauth-selective-disclosure-jwt]</dt>
        <dd>
<span class="refAuthor">Fett, D.</span>, <span class="refAuthor">Yasuda, K.</span>, and <span class="refAuthor">B. Campbell</span>, <span class="refTitle">"Selective Disclosure for JWTs (SD-JWT)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-selective-disclosure-jwt-22</span>, <time datetime="2025-05-29" class="refDate">29 May 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-selective-disclosure-jwt-22">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-selective-disclosure-jwt-22</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9421">[RFC9421]</dt>
        <dd>
<span class="refAuthor">Backman, A., Ed.</span>, <span class="refAuthor">Richer, J., Ed.</span>, and <span class="refAuthor">M. Sporny</span>, <span class="refTitle">"HTTP Message Signatures"</span>, <span class="seriesInfo">RFC 9421</span>, <span class="seriesInfo">DOI 10.17487/RFC9421</span>, <time datetime="2024-02" class="refDate">February 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9421">https://www.rfc-editor.org/info/rfc9421</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9530">[RFC9530]</dt>
      <dd>
<span class="refAuthor">Polli, R.</span> and <span class="refAuthor">L. Pardue</span>, <span class="refTitle">"Digest Fields"</span>, <span class="seriesInfo">RFC 9530</span>, <span class="seriesInfo">DOI 10.17487/RFC9530</span>, <time datetime="2024-02" class="refDate">February 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9530">https://www.rfc-editor.org/info/rfc9530</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-13.2">
        <h3 id="name-informative-references">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="EVP-Browser">[EVP-Browser]</dt>
        <dd>
<span class="refAuthor">W3C</span>, <span class="refTitle">"Email Verification Protocol Browser API"</span>, <time datetime="2025" class="refDate">2025</time>, <span>&lt;<a href="https://github.com/WICG/email-verification-protocol">https://github.com/WICG/email-verification-protocol</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6973">[RFC6973]</dt>
        <dd>
<span class="refAuthor">Cooper, A.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Morris, J.</span>, <span class="refAuthor">Hansen, M.</span>, and <span class="refAuthor">R. Smith</span>, <span class="refTitle">"Privacy Considerations for Internet Protocols"</span>, <span class="seriesInfo">RFC 6973</span>, <span class="seriesInfo">DOI 10.17487/RFC6973</span>, <time datetime="2013-07" class="refDate">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6973">https://www.rfc-editor.org/info/rfc6973</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WebAuthn">[WebAuthn]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Kumar, A.</span>, and <span class="refAuthor">E. Lundberg</span>, <span class="refTitle">"Web Authentication: An API for accessing Public Key Credentials - Level 3"</span>, <span class="seriesInfo">W3C Recommendation</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://www.w3.org/TR/webauthn-3/">https://www.w3.org/TR/webauthn-3/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">The authors would like to thank reviewers for their feedback on this specification.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dick Hardt</span></div>
<div dir="auto" class="left"><span class="org">Hellō</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dick.hardt@gmail.com" class="email">dick.hardt@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Sam Goto</span></div>
<div dir="auto" class="left"><span class="org">Google</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:goto@google.com" class="email">goto@google.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
